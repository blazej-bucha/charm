
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>charm_glob &#8212; CHarm 0.4.6 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom_BB.css" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=36da9119"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api-c-glob';</script>
    <link rel="icon" href="_static/charm-logo.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="charm" href="api-c-charm.html" />
    <link rel="prev" title="charm_mpi" href="api-c-mpi.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.4.6" />
    <meta name="docbuild:last-update" content="Apr 10, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/charm-logo.svg" class="logo__image only-light" alt=""/>
    <img src="_static/charm-logo.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">CHarm v0.4.6</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="install.html">Installing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="install-pyharm-pip.html">Installation of PyHarm with pip</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="build-from-src.html">Building from source</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="build-from-src-unix.html">Unix-based operating systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="build-from-src-non-unix.html">Windows 10 and later</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Some definitions to make things clear</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="cookbook.html">Cookbook</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="cookbook-c.html">CHarm</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook-py.html">PyHarm</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="api.html">Interfaces</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="api-c.html">CHarm (C API)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="api-c-shc.html">charm_shc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-crd.html">charm_crd</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-shs.html">charm_shs</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-sha.html">charm_sha</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-gfm.html">charm_gfm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-leg.html">charm_leg</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-integ.html">charm_integ</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-misc.html">charm_misc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-err.html">charm_err</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-mpi.html">charm_mpi</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">charm_glob</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-charm.html">charm</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api-py.html">PyHarm (Python API)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="api-py-shc.html">pyharm.shc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-crd.html">pyharm.crd</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-shs.html">pyharm.shs</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-sha.html">pyharm.sha</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-gfm.html">pyharm.gfm</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-leg.html">pyharm.leg</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-integ.html">pyharm.integ</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-misc.html">pyharm.misc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-glob.html">pyharm.glob</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="platforms.html">Tested platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/blazej-bucha/charm" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/blazej-bucha/charm/edit/master/docs/src/api-c-glob.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/blazej-bucha/charm/issues/new?title=Issue%20on%20page%20%2Fapi-c-glob.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/api-c-glob.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>charm_glob</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv420charm_glob_threshold"><code class="docutils literal notranslate"><span class="pre">charm_glob_threshold</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv421charm_glob_threshold2"><code class="docutils literal notranslate"><span class="pre">charm_glob_threshold2</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv432charm_glob_polar_optimization_a1"><code class="docutils literal notranslate"><span class="pre">charm_glob_polar_optimization_a1</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv432charm_glob_polar_optimization_a2"><code class="docutils literal notranslate"><span class="pre">charm_glob_polar_optimization_a2</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv436charm_glob_shc_block_nmax_multiplier"><code class="docutils literal notranslate"><span class="pre">charm_glob_shc_block_nmax_multiplier</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv435charm_glob_sha_block_lat_multiplier"><code class="docutils literal notranslate"><span class="pre">charm_glob_sha_block_lat_multiplier</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv435charm_glob_shs_block_lat_multiplier"><code class="docutils literal notranslate"><span class="pre">charm_glob_shs_block_lat_multiplier</span></code></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="charm-glob">
<span id="id1"></span><h1>charm_glob<a class="headerlink" href="#charm-glob" title="Link to this heading">#</a></h1>
<p>Module defining global CHarm variables.</p>
<p>The global variables are declared in <code class="docutils literal notranslate"><span class="pre">charm_glob.h</span></code> and are initialized to safe values. Should you need to modify them for some reason, simply include <code class="docutils literal notranslate"><span class="pre">charm_glob.h</span></code> (or <code class="docutils literal notranslate"><span class="pre">charm.h</span></code>) in your code and set (without definition) the variables to whatever values you prefer. After that, whenever you call a CHarm routine that uses the global variables, the routine will use your own values instead of the default ones.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This module is for experienced users only.  Most users should not
interact with it.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This documentation is written for double precision version of CHarm. </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-thresholds-used-to-compare-floating-point-numbers">Thresholds used to compare floating point numbers</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420charm_glob_threshold">
<span id="_CPPv320charm_glob_threshold"></span><span id="_CPPv220charm_glob_threshold"></span><span id="charm_glob_threshold__double"></span><span class="target" id="charm__glob_8h_1ab38bfd45ebf0f622c892ec1d0045c601"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_glob_threshold</span></span></span><a class="headerlink" href="#_CPPv420charm_glob_threshold" title="Link to this definition">#</a><br /></dt>
<dd><p>Threshold to judge whether two floating point numbers are equal, <code class="docutils literal notranslate"><span class="pre">100.0</span> <span class="pre">*</span> <span class="pre">EPS</span></code>, where <code class="docutils literal notranslate"><span class="pre">EPS</span></code> is the machine epsilon of the floating point data type (<code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code> or <code class="docutils literal notranslate"><span class="pre">__float128</span></code>). Experienced users may (under some very specific circumstances) need the possibility to tighten or relax the threshold. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421charm_glob_threshold2">
<span id="_CPPv321charm_glob_threshold2"></span><span id="_CPPv221charm_glob_threshold2"></span><span id="charm_glob_threshold2__double"></span><span class="target" id="charm__glob_8h_1afb419caab47d66aff55c04d1339b4f7d"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_glob_threshold2</span></span></span><a class="headerlink" href="#_CPPv421charm_glob_threshold2" title="Link to this definition">#</a><br /></dt>
<dd><p>A more relaxed threshold to judge whether two floating point numbers are equal, <code class="docutils literal notranslate"><span class="pre">100000.0</span> <span class="pre">*</span> <span class="pre">EPS</span></code>. It is used to check longitudes of <em>custom</em> user-defined grids for a constant longitudinal step (required by the FFT-based algorithms). To this end, we use double differences. For high-resolution grids, the longitudinal step may be very small, so that two consecutive longitudes are very similar. Since double differences increase numerical errors, the threshold needs to be sufficiently large in such situations (yet narrow enough). The current value was found to be sufficient for quadrature grids associated with degrees as high as <code class="docutils literal notranslate"><span class="pre">70,000</span></code>. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-parameters-defining-the-polar-optimization">Parameters defining the polar optimization</p>
<p>CHarm can be told to skip the computation of all spherical harmonics during spherical harmonic synthesis/analysis for which</p>
<p><p><div class="math notranslate nohighlight">
\[m - n_{\max} \, \cos\varphi &gt; \max(a_1, a_2 \, n_{\max}){.}\]</div>
</p>
</p>
<p>If the parameters <code class="docutils literal notranslate"><span class="pre">a1</span></code> and <code class="docutils literal notranslate"><span class="pre">a2</span></code> (see <code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1a912f3a473bd2a2762a005616916dbe52"><span class="std std-ref"><span class="pre">charm_glob_polar_optimization_a1</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1ab5fc3b2f3555814f59ea7d7fd8004de0"><span class="std std-ref"><span class="pre">charm_glob_polar_optimization_a2</span></span></a></code>) are tuned reasonably, the polar optimization can improve the computation speed while <em>not</em> deteriorating the output accuracy. This is because the inequality filters out spherical harmonics that are of such small magnitudes in the polar areas that they do not contribute to the result (within the numerical precision). However, if the parameters are set unwisely, the accuracy can be compromised.</p>
<p>If the second polar optimization parameter <code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1ab5fc3b2f3555814f59ea7d7fd8004de0"><span class="std std-ref"><span class="pre">charm_glob_polar_optimization_a2</span></span></a></code> is negative (which is the default), <em>no</em> polar optimization is applied, that is, all spherical harmonics are evaluated, regardless of their smallness in magnitude. If it is non-negative, the polar optimization is applied.</p>
<p>In <strong>double</strong> precision, the following values of the tuning parameters improve the computation speed and, in most cases, can safely be used without deteriorating the accuracy (Reinecke and Seljebotn, 2013):</p>
<p><ul class="simple">
<li><p><code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1a912f3a473bd2a2762a005616916dbe52"><span class="std std-ref"><span class="pre">charm_glob_polar_optimization_a1</span></span></a> <span class="pre">=</span> <span class="pre">100</span></code> and</p></li>
<li><p><code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1ab5fc3b2f3555814f59ea7d7fd8004de0"><span class="std std-ref"><span class="pre">charm_glob_polar_optimization_a2</span></span></a> <span class="pre">=</span> <span class="pre">0.01</span></code>.</p></li>
</ul>
</p>
<p>In single and quadruple precision, different values of the tuning parameters are needed. Currently, we do not provide any recommendations, though.</p>
<p><strong>References</strong>:</p>
<p><ul class="simple">
<li><p>Reinecke, M., Seljebotn, D. S. (2013) Libsharp - spherical harmonic transforms revisited. Astronomy and Astrophysics 554, A112, doi: 10.1051/0004-6361/201321494. </p></li>
</ul>
</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv432charm_glob_polar_optimization_a1">
<span id="_CPPv332charm_glob_polar_optimization_a1"></span><span id="_CPPv232charm_glob_polar_optimization_a1"></span><span id="charm_glob_polar_optimization_a1__unsigned-l"></span><span class="target" id="charm__glob_8h_1a912f3a473bd2a2762a005616916dbe52"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_glob_polar_optimization_a1</span></span></span><a class="headerlink" href="#_CPPv432charm_glob_polar_optimization_a1" title="Link to this definition">#</a><br /></dt>
<dd><p>Polar optimization parameter (default is <code class="docutils literal notranslate"><span class="pre">100</span></code>) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv432charm_glob_polar_optimization_a2">
<span id="_CPPv332charm_glob_polar_optimization_a2"></span><span id="_CPPv232charm_glob_polar_optimization_a2"></span><span id="charm_glob_polar_optimization_a2__double"></span><span class="target" id="charm__glob_8h_1ab5fc3b2f3555814f59ea7d7fd8004de0"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_glob_polar_optimization_a2</span></span></span><a class="headerlink" href="#_CPPv432charm_glob_polar_optimization_a2" title="Link to this definition">#</a><br /></dt>
<dd><p>Polar optimization parameter (default is <code class="docutils literal notranslate"><span class="pre">-1.0</span></code>, that is, no polar optimization) </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-mpi-specific-global-variables">MPI specific global variables</p>
<p><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The variables that follow are available only when CHarm is compiled with the MPI support (<code class="docutils literal notranslate"><span class="pre">--enable-mpi</span></code>, refer to <a class="reference external" href="./api-c-mpi.html">charm_mpi</a> for further details). </p>
</div>
</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv436charm_glob_shc_block_nmax_multiplier">
<span id="_CPPv336charm_glob_shc_block_nmax_multiplier"></span><span id="_CPPv236charm_glob_shc_block_nmax_multiplier"></span><span id="charm_glob_shc_block_nmax_multiplier__unsigned-l"></span><span class="target" id="charm__glob_8h_1a7da2a9a23fa487751edb6bc92af85c3a"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_glob_shc_block_nmax_multiplier</span></span></span><a class="headerlink" href="#_CPPv436charm_glob_shc_block_nmax_multiplier" title="Link to this definition">#</a><br /></dt>
<dd><p>Multiplying this variable by the maximum harmonic degree of spherical harmonic coefficients enlarged by <code class="docutils literal notranslate"><span class="pre">1</span></code> specifies the maximum number of coefficients that can be exchanged between MPI processes during spherical harmonic synthesis/analysis with distributed <code class="docutils literal notranslate"><a class="reference internal" href="api-c-shc.html#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code>. </p>
<p>Assume that <code class="docutils literal notranslate"><a class="reference internal" href="api-c-shc.html#structcharm__shc_1a8d7afa2ae075e75529008ec97ee20b1b"><span class="std std-ref"><span class="pre">charm_shc.distributed</span></span></a> <span class="pre">=</span> <span class="pre">1</span></code>. During the spherical harmonic synthesis/analysis, <code class="docutils literal notranslate"><span class="pre">(</span><a class="reference internal" href="api-c-shc.html#structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"><span class="std std-ref"><span class="pre">charm_shc.nmax</span></span></a> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">*</span> <a class="reference internal" href="#charm__glob_8h_1a7da2a9a23fa487751edb6bc92af85c3a"><span class="std std-ref"><span class="pre">charm_glob_shc_block_nmax_multiplier</span></span></a></code> spherical harmonic coefficients <span class="math notranslate nohighlight">\(\bar{C}_{nm}\)</span> and the same amount of <span class="math notranslate nohighlight">\(\bar{S}_{nm}\)</span> coefficients will be sent between MPI processes at most. Too small value of <code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1a7da2a9a23fa487751edb6bc92af85c3a"><span class="std std-ref"><span class="pre">charm_glob_shc_block_nmax_multiplier</span></span></a></code> will cause too large overhead due to MPI calls. On the other hand, too large value will consume too much RAM on each MPI process.</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">1000</span></code>. The value must be larger than zero. If it is zero, CHarm will use the value <code class="docutils literal notranslate"><span class="pre">1</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv435charm_glob_sha_block_lat_multiplier">
<span id="_CPPv335charm_glob_sha_block_lat_multiplier"></span><span id="_CPPv235charm_glob_sha_block_lat_multiplier"></span><span id="charm_glob_sha_block_lat_multiplier__s"></span><span class="target" id="charm__glob_8h_1abddf129834cf748518d7c9a6ae15fe23"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_glob_sha_block_lat_multiplier</span></span></span><a class="headerlink" href="#_CPPv435charm_glob_sha_block_lat_multiplier" title="Link to this definition">#</a><br /></dt>
<dd><p>This variable helps to control the number of <code class="docutils literal notranslate"><span class="pre">for</span></code> loop iterations over latitudes in <code class="docutils literal notranslate"><a class="reference internal" href="api-c-sha.html#charm__sha_8h_1ae98177417defe2a6344b7fb62a1c74a7"><span class="std std-ref"><span class="pre">charm_sha_point()</span></span></a></code>. It has enormous impact on the performance of <code class="docutils literal notranslate"><a class="reference internal" href="api-c-sha.html#charm__sha_8h_1ae98177417defe2a6344b7fb62a1c74a7"><span class="std std-ref"><span class="pre">charm_sha_point()</span></span></a></code> when CHarm is compiled with the MPI support. </p>
<p>Let <code class="docutils literal notranslate"><span class="pre">x</span></code> by the number of latitudes, for which the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop over latitudes in <code class="docutils literal notranslate"><a class="reference internal" href="api-c-sha.html#charm__sha_8h_1ae98177417defe2a6344b7fb62a1c74a7"><span class="std std-ref"><span class="pre">charm_sha_point()</span></span></a></code> runs. Usually, this number is about half of the number of latitudes of quadrature grids due to their equatorial symmetry. Furthermore, let <code class="docutils literal notranslate"><span class="pre">b</span></code> be the value of <code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1abddf129834cf748518d7c9a6ae15fe23"><span class="std std-ref"><span class="pre">charm_glob_sha_block_lat_multiplier</span></span></a></code>. Finally, let <code class="docutils literal notranslate"><span class="pre">s</span></code> be the size of SIMD vectors (can be determined by <code class="docutils literal notranslate"><a class="reference internal" href="api-c-misc.html#charm__misc_8h_1ad3ae4644b756ab034a808dd4cc2b6904"><span class="std std-ref"><span class="pre">charm_misc_buildopt_simd_vector_size()</span></span></a></code>) and <code class="docutils literal notranslate"><span class="pre">o</span></code> be the number of OpenMP processes (if OpenMP parallelization is disabled, then <code class="docutils literal notranslate"><span class="pre">o</span> <span class="pre">=</span> <span class="pre">1</span></code>). The <code class="docutils literal notranslate"><span class="pre">for</span></code> loop in <code class="docutils literal notranslate"><a class="reference internal" href="api-c-sha.html#charm__sha_8h_1ae98177417defe2a6344b7fb62a1c74a7"><span class="std std-ref"><span class="pre">charm_sha_point()</span></span></a></code> will run roughly <code class="docutils literal notranslate"><span class="pre">ceil(x</span> <span class="pre">/</span> <span class="pre">(b</span> <span class="pre">*</span> <span class="pre">s</span> <span class="pre">*</span> <span class="pre">o))</span></code> times. Thus, by increasing <code class="docutils literal notranslate"><span class="pre">b</span></code> (and optionally also <code class="docutils literal notranslate"><span class="pre">o</span></code>), the number of loop runs can be decreased.</p>
<p>The optimal value depends on your hardware (e.g., the number of shared-memory computing nodes, the network connection speed between the nodes, etc.) and also on the number of latitudes. Both too low and too high values may <em>drastically</em> deteriorate the performance.</p>
<p><ul class="simple">
<li><p>If the value is too low, the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop will run many times. This is a serious problem, because with each loop iteration, <em>all</em> spherical harmonic coefficients need to be distributed among <em>all</em> MPI processes within an MPI communicator. So by increasing <code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1abddf129834cf748518d7c9a6ae15fe23"><span class="std std-ref"><span class="pre">charm_glob_sha_block_lat_multiplier</span></span></a></code>, you can reduce the number of times the spherical harmonic coefficients will be sent between MPI processes which is desired in general.</p></li>
<li><p>If the value is too high, the CPU caching within a single computing node may be significantly deteriorated, thereby decreasing the performance.</p></li>
</ul>
</p>
<p>The optimum value should be determined by the trial and error method.</p>
<p>The parameter affects <code class="docutils literal notranslate"><a class="reference internal" href="api-c-sha.html#charm__sha_8h_1ae98177417defe2a6344b7fb62a1c74a7"><span class="std std-ref"><span class="pre">charm_sha_point()</span></span></a></code> regardless of whether or not <code class="docutils literal notranslate"><a class="reference internal" href="api-c-shc.html#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="api-c-crd.html#structcharm__point"><span class="std std-ref"><span class="pre">charm_point</span></span></a></code> are distributed. The value must be larger than <code class="docutils literal notranslate"><span class="pre">0</span></code>. If it is <code class="docutils literal notranslate"><span class="pre">0</span></code>, CHarm will use the value <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">4</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv435charm_glob_shs_block_lat_multiplier">
<span id="_CPPv335charm_glob_shs_block_lat_multiplier"></span><span id="_CPPv235charm_glob_shs_block_lat_multiplier"></span><span id="charm_glob_shs_block_lat_multiplier__s"></span><span class="target" id="charm__glob_8h_1a5cab8fad12033c5fa29c47726665cd40"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_glob_shs_block_lat_multiplier</span></span></span><a class="headerlink" href="#_CPPv435charm_glob_shs_block_lat_multiplier" title="Link to this definition">#</a><br /></dt>
<dd><p>The same as <code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1abddf129834cf748518d7c9a6ae15fe23"><span class="std std-ref"><span class="pre">charm_glob_sha_block_lat_multiplier</span></span></a></code> but for spherical harmonic synthesis in <code class="docutils literal notranslate"><a class="reference internal" href="api-c-shs.html#charm__shs_8h_1a47e78422d29ab4668f6140fe8a5b16af"><span class="std std-ref"><span class="pre">charm_shs_point()</span></span></a></code>. </p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">8</span></code>. </p>
</dd></dl>

</div>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="api-c-mpi.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">charm_mpi</p>
      </div>
    </a>
    <a class="right-next"
       href="api-c-charm.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">charm</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv420charm_glob_threshold"><code class="docutils literal notranslate"><span class="pre">charm_glob_threshold</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv421charm_glob_threshold2"><code class="docutils literal notranslate"><span class="pre">charm_glob_threshold2</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv432charm_glob_polar_optimization_a1"><code class="docutils literal notranslate"><span class="pre">charm_glob_polar_optimization_a1</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv432charm_glob_polar_optimization_a2"><code class="docutils literal notranslate"><span class="pre">charm_glob_polar_optimization_a2</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv436charm_glob_shc_block_nmax_multiplier"><code class="docutils literal notranslate"><span class="pre">charm_glob_shc_block_nmax_multiplier</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv435charm_glob_sha_block_lat_multiplier"><code class="docutils literal notranslate"><span class="pre">charm_glob_sha_block_lat_multiplier</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv435charm_glob_shs_block_lat_multiplier"><code class="docutils literal notranslate"><span class="pre">charm_glob_shs_block_lat_multiplier</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Blažej Bucha
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Blažej Bucha.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Apr 10, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>