
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>charm_shc &#8212; CHarm 0.4.2-dev documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom_BB.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=3620f092"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api-c-shc';</script>
    <link rel="icon" href="_static/charm-logo.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="charm_crd" href="api-c-crd.html" />
    <link rel="prev" title="CHarm (C API)" href="api-c.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Nov 19, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/charm-logo.svg" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="_static/charm-logo.svg" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">CHarm v0.4.2-dev</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="install.html">Installing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="install-pyharm-pip.html">Installation of PyHarm with pip</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="build-from-src.html">Building from source</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="build-from-src-unix.html">Unix-based operating systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="build-from-src-non-unix.html">Windows 10 and later</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Some definitions to make things clear</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="cookbook.html">Cookbook</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="cookbook-c.html">CHarm</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook-py.html">PyHarm</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="api.html">Interfaces</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="api-c.html">CHarm (C API)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">charm_shc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-crd.html">charm_crd</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-shs.html">charm_shs</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-sha.html">charm_sha</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-leg.html">charm_leg</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-integ.html">charm_integ</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-misc.html">charm_misc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-err.html">charm_err</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-mpi.html">charm_mpi</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-glob.html">charm_glob</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-charm.html">charm</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api-py.html">PyHarm (Python API)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="api-py-shc.html">pyharm.shc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-crd.html">pyharm.crd</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-shs.html">pyharm.shs</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-sha.html">pyharm.sha</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-leg.html">pyharm.leg</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-integ.html">pyharm.integ</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-misc.html">pyharm.misc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-py-glob.html">pyharm.glob</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="platforms.html">Tested platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/blazej-bucha/charm" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/blazej-bucha/charm/edit/master/docs/src/api-c-shc.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/blazej-bucha/charm/issues/new?title=Issue%20on%20page%20%2Fapi-c-shc.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/api-c-shc.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>charm_shc</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv416charm_shc_mallocmdd"><code class="docutils literal notranslate"><span class="pre">charm_shc_malloc()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv416charm_shc_callocmdd"><code class="docutils literal notranslate"><span class="pre">charm_shc_calloc()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv414charm_shc_initmddPdPd"><code class="docutils literal notranslate"><span class="pre">charm_shc_init()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv414charm_shc_freeP9charm_shc"><code class="docutils literal notranslate"><span class="pre">charm_shc_free()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv418charm_shc_read_binPKcmP9charm_shcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_read_bin()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv418charm_shc_read_gfcPKcmPKcP9charm_shcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_read_gfc()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv418charm_shc_read_tblPKcmP9charm_shcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_read_tbl()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv418charm_shc_read_dovPKcmP9charm_shcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_read_dov()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv418charm_shc_read_mtxPKcmP9charm_shcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_read_mtx()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv419charm_shc_write_binPK9charm_shcmPKcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_write_bin()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv419charm_shc_write_tblPK9charm_shcmPKciPKcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_write_tbl()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv419charm_shc_write_dovPK9charm_shcmPKciPKcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_write_dov()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv419charm_shc_write_mtxPK9charm_shcmPKcPKcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_write_mtx()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv412charm_shc_dvPK9charm_shcmPdP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_dv()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv412charm_shc_daPK9charm_shcmPdP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_da()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv413charm_shc_ddvPK9charm_shcPK9charm_shcmPdP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_ddv()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv413charm_shc_ddaPK9charm_shcPK9charm_shcmPdP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_dda()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv417charm_shc_rescaleP9charm_shcddP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_rescale()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4Ut1_4"><code class="docutils literal notranslate"><span class="pre">@4</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NUt1_417CHARM_SHC_WRITE_NE"><code class="docutils literal notranslate"><span class="pre">@4::CHARM_SHC_WRITE_N</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NUt1_417CHARM_SHC_WRITE_ME"><code class="docutils literal notranslate"><span class="pre">@4::CHARM_SHC_WRITE_M</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv49charm_shc"><code class="docutils literal notranslate"><span class="pre">charm_shc</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc4nmaxE"><code class="docutils literal notranslate"><span class="pre">charm_shc::nmax</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc2muE"><code class="docutils literal notranslate"><span class="pre">charm_shc::mu</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc1rE"><code class="docutils literal notranslate"><span class="pre">charm_shc::r</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc2ncE"><code class="docutils literal notranslate"><span class="pre">charm_shc::nc</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc2nsE"><code class="docutils literal notranslate"><span class="pre">charm_shc::ns</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc1cE"><code class="docutils literal notranslate"><span class="pre">charm_shc::c</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc1sE"><code class="docutils literal notranslate"><span class="pre">charm_shc::s</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc5ownerE"><code class="docutils literal notranslate"><span class="pre">charm_shc::owner</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc11distributedE"><code class="docutils literal notranslate"><span class="pre">charm_shc::distributed</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc8local_ncE"><code class="docutils literal notranslate"><span class="pre">charm_shc::local_nc</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc8local_nsE"><code class="docutils literal notranslate"><span class="pre">charm_shc::local_ns</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc12local_nchunkE"><code class="docutils literal notranslate"><span class="pre">charm_shc::local_nchunk</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc11local_orderE"><code class="docutils literal notranslate"><span class="pre">charm_shc::local_order</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc4commE"><code class="docutils literal notranslate"><span class="pre">charm_shc::comm</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="charm-shc">
<span id="id1"></span><h1>charm_shc<a class="headerlink" href="#charm-shc" title="Link to this heading">#</a></h1>
<p>Module to work with spherical harmonic coefficients:</p>
<p><ul class="simple">
<li><p>defines the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure to store spherical harmonic coefficients,</p></li>
<li><p>allocates, initializes and frees <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code>,</p></li>
<li><p>reads/writes spherical harmonic coefficients from/to text and binary files,</p></li>
<li><p>computes (difference) degree variances and degree amplitudes.</p></li>
<li><p>rescales spherical harmonic coefficients,</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This documentation is written for double precision version of CHarm. </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-special-values-for-functions-to-read-spherical-harmonic-coefficients">Special values for functions to read spherical harmonic coefficients</p>
<p>The values are used with <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a8964cfa35210c0504a66352d4a08de62"><span class="std std-ref"><span class="pre">charm_shc_read_dov()</span></span></a></code>, <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1af6995bacff72c260aecb449bf9a41967"><span class="std std-ref"><span class="pre">charm_shc_read_gfc()</span></span></a></code>, <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1ad38866f0da4c14d02631c4ddbb723a1a"><span class="std std-ref"><span class="pre">charm_shc_read_tbl()</span></span></a></code>, <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a15f826d9e23977fd774db07c11a22939"><span class="std std-ref"><span class="pre">charm_shc_read_mtx()</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a8964cfa35210c0504a66352d4a08de62"><span class="std std-ref"><span class="pre">charm_shc_read_dov()</span></span></a></code>. </p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CHARM_SHC_NMAX_MODEL">
<span class="target" id="charm__shc_8h_1a386fcf3135c8b896e0ab20d4ab63c5a2"></span><span class="sig-name descname"><span class="n"><span class="pre">CHARM_SHC_NMAX_MODEL</span></span></span> <span class="pre">(ULONG_MAX</span> <span class="pre">-</span> <span class="pre">1)</span><a class="headerlink" href="#c.CHARM_SHC_NMAX_MODEL" title="Link to this definition">#</a><br /></dt>
<dd><p>Special value of the <code class="docutils literal notranslate"><span class="pre">nmax</span></code> input parameter to all functions that read spherical harmonic coefficients. If <code class="docutils literal notranslate"><span class="pre">nmax</span></code> is <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a386fcf3135c8b896e0ab20d4ab63c5a2"><span class="std std-ref"><span class="pre">CHARM_SHC_NMAX_MODEL</span></span></a></code> and <code class="docutils literal notranslate"><span class="pre">shcs</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, the functions return the maximum harmonic degree found inside the file and do not read the rest of the file (see the documentation to <code class="docutils literal notranslate"><span class="pre">charm_shc_read_*</span></code> functions). The value is platform-dependent. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CHARM_SHC_NMAX_ERROR">
<span class="target" id="charm__shc_8h_1a81159bc53ff0bf69090ab5e066739849"></span><span class="sig-name descname"><span class="n"><span class="pre">CHARM_SHC_NMAX_ERROR</span></span></span> <span class="pre">(ULONG_MAX)</span><a class="headerlink" href="#c.CHARM_SHC_NMAX_ERROR" title="Link to this definition">#</a><br /></dt>
<dd><p>Special value signalizing that a function to read spherical harmonic coefficients encountered an error. The value is platform-dependent. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-allocate,-initialize-and-free-the-charm_shc-structure">Allocate, initialize and free the charm_shc structure</p>
<p>These functions allocate, initialize and free the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure, which is designed to store spherical harmonic coefficients and some associated data such as the maximum degree of the coefficients, scaling constant, etc. </p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416charm_shc_mallocmdd">
<span id="_CPPv316charm_shc_mallocmdd"></span><span id="_CPPv216charm_shc_mallocmdd"></span><span id="charm_shc_malloc__unsigned-l.double.double"></span><span class="target" id="charm__shc_8h_1a4895f2b307f1ce52ed05804ab6db9df8"></span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_malloc</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">mu</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416charm_shc_mallocmdd" title="Link to this definition">#</a><br /></dt>
<dd><p>Allocates spherical harmonic coefficients up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code>. The <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a241fa5b0edae9a1574e948e5a6269b68"><span class="std std-ref"><span class="pre">charm_shc.mu</span></span></a></code>, <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a847dadddf26eeffc5b5060f4f745d20a"><span class="std std-ref"><span class="pre">charm_shc.r</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1afa2a47ef5dfb21b8c01fa506b17859af"><span class="std std-ref"><span class="pre">charm_shc.owner</span></span></a></code> members are set to <code class="docutils literal notranslate"><span class="pre">mu</span></code>, <code class="docutils literal notranslate"><span class="pre">r</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code>, respectively. The spherical harmonic coefficients are uninitialized, so their values are undefined. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">r</span></code> must be larger than zero. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The structure returned must be deallocated by calling <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1ac787c43697c5383d38c392d427b78669"><span class="std std-ref"><span class="pre">charm_shc_free()</span></span></a></code>. The <code class="docutils literal notranslate"><span class="pre">free</span></code> function will <em>not</em> deallocate the memory and will lead to memory leaks.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>On success, returned is a pointer to the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure. On error, <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is returned.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416charm_shc_callocmdd">
<span id="_CPPv316charm_shc_callocmdd"></span><span id="_CPPv216charm_shc_callocmdd"></span><span id="charm_shc_calloc__unsigned-l.double.double"></span><span class="target" id="charm__shc_8h_1abc13dd997021be52d8f317562738ad14"></span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_calloc</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">mu</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416charm_shc_callocmdd" title="Link to this definition">#</a><br /></dt>
<dd><p>The same as <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a4895f2b307f1ce52ed05804ab6db9df8"><span class="std std-ref"><span class="pre">charm_shc_malloc()</span></span></a></code> but all spherical harmonic coefficients are initialized to zero. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414charm_shc_initmddPdPd">
<span id="_CPPv314charm_shc_initmddPdPd"></span><span id="_CPPv214charm_shc_initmddPdPd"></span><span id="charm_shc_init__unsigned-l.double.double.doubleP.doubleP"></span><span class="target" id="charm__shc_8h_1a634b6af02cca801de4e51c2248d72b20"></span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_init</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">mu</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">c</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">s</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414charm_shc_initmddPdPd" title="Link to this definition">#</a><br /></dt>
<dd><p>Takes spherical harmonic coefficients up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code> from the arrays pointed to by <code class="docutils literal notranslate"><span class="pre">c</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code> (shallow copy). The <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a241fa5b0edae9a1574e948e5a6269b68"><span class="std std-ref"><span class="pre">charm_shc.mu</span></span></a></code>, <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a847dadddf26eeffc5b5060f4f745d20a"><span class="std std-ref"><span class="pre">charm_shc.r</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1afa2a47ef5dfb21b8c01fa506b17859af"><span class="std std-ref"><span class="pre">charm_shc.owner</span></span></a></code> members are set to <code class="docutils literal notranslate"><span class="pre">mu</span></code>, <code class="docutils literal notranslate"><span class="pre">r</span></code> and <code class="docutils literal notranslate"><span class="pre">0</span></code>, respectively. </p>
<p>
The <code class="docutils literal notranslate"><span class="pre">c</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code> pointers must have access to <code class="docutils literal notranslate"><span class="pre">((nmax</span> <span class="pre">+</span> <span class="pre">2)</span> <span class="pre">*</span> <span class="pre">(nmax</span> <span class="pre">+</span> <span class="pre">1))</span> <span class="pre">/</span> <span class="pre">2</span></code> array elements. The ordering of coefficients in <code class="docutils literal notranslate"><span class="pre">c</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code> must follow the pattern:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}&amp;\bar{C}_{0,0}, \, \bar{C}_{1,0},\bar{C}_{2,0}, \, \cdots,
\bar{C}_{\mathrm{nmax},0}, \bar{C}_{1,1},\, \bar{C}_{2,1}, \, \cdots,\\
&amp;\bar{C}_{\mathrm{nmax},1}, \, \bar{C}_{2,2}, \bar{C}_{3,2},\,
\cdots,\, \bar{C}_{\mathrm{nmax},\mathrm{nmax}},\end{split}\]</div>
</p>
<p>and</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}&amp;\bar{S}_{0,0}, \, \bar{S}_{1,0},\bar{S}_{2,0}, \, \cdots,
\bar{S}_{\mathrm{nmax},0}, \bar{S}_{1,1},\, \bar{S}_{2,1}, \, \cdots,\\
&amp;\bar{S}_{\mathrm{nmax},1}, \, \bar{S}_{2,2}, \bar{S}_{3,2},\,
\cdots,\, \bar{S}_{\mathrm{nmax},\mathrm{nmax}},\end{split}\]</div>
</p>
<p>respectively. Be careful here and always put the product <code class="docutils literal notranslate"><span class="pre">(nmax</span> <span class="pre">+</span> <span class="pre">2)</span> <span class="pre">*</span> <span class="pre">(nmax</span> <span class="pre">+</span> <span class="pre">1)</span></code> into brackets to ensure correct rounding when subsequently dividing by <code class="docutils literal notranslate"><span class="pre">2</span></code> as shown above.</p>
<p>The rationale behind this function is to provide a means to create the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure from custom arrays of spherical harmonic coefficients <em>without a deep copy of the data</em>. The following code snippet illustrates this:</p>
<p><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">nmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>

<span class="kt">size_t</span><span class="w"> </span><span class="n">ncs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">nmax</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">nmax</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">myc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">ncs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">mys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">ncs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>

<span class="c1">// Now fill &quot;myc&quot; and &quot;mys&quot; with your coefficients.</span>
<span class="c1">// [Here goes your code]</span>

<span class="c1">// Next, create the &quot;charm_shc&quot; structure from the &quot;myc&quot; and &quot;mys&quot;</span>
<span class="c1">// coefficients:</span>
<span class="n">charm_shc</span><span class="w"> </span><span class="o">*</span><span class="n">shcs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">charm_shc_init</span><span class="p">(</span><span class="n">nmax</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">myc</span><span class="p">,</span><span class="w"> </span><span class="n">mys</span><span class="p">);</span>

<span class="c1">// Do some cool things here with &quot;shcs&quot;, but remember that</span>
<span class="c1">// &quot;shcs-&gt;c&quot; and &quot;shcs-&gt;s&quot; share the memory space with &quot;myc&quot; and</span>
<span class="c1">// &quot;mys&quot;, respectively.</span>
<span class="c1">// [Here goes your code]</span>

<span class="c1">// At this point, we did everything we needed to do with &quot;shcs&quot;, so</span>
<span class="c1">// let&#39;s release the memory associated with it.</span>
<span class="n">charm_shc_free</span><span class="p">(</span><span class="n">shcs</span><span class="p">);</span>
<span class="c1">// The &quot;shcs&quot; structure is now properly released. But</span>
<span class="c1">// since &quot;shcs&quot; was created by &quot;charm_shc_init&quot;, which does not</span>
<span class="c1">// perform a deep copy of the coefficients in &quot;myc&quot; and &quot;mys&quot;, the</span>
<span class="c1">// memory associated with &quot;myc&quot; and &quot;mys&quot; was not freed.  At this</span>
<span class="c1">// point, you may therefore still use &quot;myc&quot; and &quot;mys&quot;.</span>
<span class="c1">// [Here goes your code]</span>

<span class="c1">// Once you are done with &quot;myc&quot; and &quot;mys&quot;, release the memory as</span>
<span class="c1">// usually with:</span>
<span class="n">free</span><span class="p">(</span><span class="n">myc</span><span class="p">);</span>
<span class="n">free</span><span class="p">(</span><span class="n">mys</span><span class="p">);</span>
</pre></div>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">r</span></code> must be larger than zero. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The structure returned must be deallocated by calling <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1ac787c43697c5383d38c392d427b78669"><span class="std std-ref"><span class="pre">charm_shc_free()</span></span></a></code>. The <code class="docutils literal notranslate"><span class="pre">free</span></code> function will <em>not</em> deallocate the memory and will lead to memory leaks.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The spherical harmonic coefficients in the returned <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure share the memory space with the input <code class="docutils literal notranslate"><span class="pre">c</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code> arrays. The function does not perform a deep copy of the data. Therefore, <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1ac787c43697c5383d38c392d427b78669"><span class="std std-ref"><span class="pre">charm_shc_free()</span></span></a></code> properly deallocates the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure <em>except</em> for the spherical harmonic coefficients. The user allocated <code class="docutils literal notranslate"><span class="pre">c</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code> outside the scope of CHarm, so the user decides when to deallocate.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>On success, returned is a pointer to the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure. On error, <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is returned.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414charm_shc_freeP9charm_shc">
<span id="_CPPv314charm_shc_freeP9charm_shc"></span><span id="_CPPv214charm_shc_freeP9charm_shc"></span><span id="charm_shc_free__charm_shcP"></span><span class="target" id="charm__shc_8h_1ac787c43697c5383d38c392d427b78669"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414charm_shc_freeP9charm_shc" title="Link to this definition">#</a><br /></dt>
<dd><p>Frees the memory associated with <code class="docutils literal notranslate"><span class="pre">shcs</span></code>. No operation is performed if <code class="docutils literal notranslate"><span class="pre">shcs</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>. </p>
<p>If <code class="docutils literal notranslate"><span class="pre">shcs-&gt;owner</span></code> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, the function releases all the memory that is associated with <code class="docutils literal notranslate"><span class="pre">shcs</span></code>, including the arrays of spherical harmonic coefficients. If <code class="docutils literal notranslate"><span class="pre">shcs-&gt;owner</span></code> is <code class="docutils literal notranslate"><span class="pre">0</span></code>, the coefficients are not released from the memory, because they were not allocated by CHarm. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-read-and-write-the-charm_shc-structure">Read and write the charm_shc structure</p>
<p>These functions read/write the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure from/to various text and binary data files. </p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418charm_shc_read_binPKcmP9charm_shcP9charm_err">
<span id="_CPPv318charm_shc_read_binPKcmP9charm_shcP9charm_err"></span><span id="_CPPv218charm_shc_read_binPKcmP9charm_shcP9charm_err"></span><span id="charm_shc_read_bin__cCP.unsigned-l.charm_shcP.charm_errP"></span><span class="target" id="charm__shc_8h_1acc95468910353585b941c4ee85b439d6"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_read_bin</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pathname</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418charm_shc_read_binPKcmP9charm_shcP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Reads the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure to <code class="docutils literal notranslate"><span class="pre">shcs</span></code> from a binary file whose name is the string pointed to by <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. The spherical harmonic coefficients are loaded up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code>. The file is assumed to has been created by <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1acd4b855357c012625ddf89a6625970dd"><span class="std std-ref"><span class="pre">charm_shc_write_bin()</span></span></a></code> on the same architecture. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
<p>The input file is a binary representation of the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure in the following order:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}&amp;\mathrm{nmax\_file}, \, \mu, \, R, \bar{C}_{0,0}, \, 
\bar{C}_{1,0},\bar{C}_{2,0}, \, \cdots,
\bar{C}_{\mathrm{nmax\_file},0}, \bar{C}_{1,1},\, \bar{C}_{2,1}, \,
\cdots,\\
&amp;\bar{C}_{\mathrm{nmax\_file},1}, \, \bar{C}_{2,2},
\bar{C}_{3,2},\, \cdots,\,
\bar{C}_{\mathrm{nmax\_file},\mathrm{nmax\_file}},\, 
\bar{S}_{0,0},\, \bar{S}_{1,0},\, \bar{S}_{2,0},\, \cdots,\\
&amp;\bar{S}_{\mathrm{nmax\_file},0},\, \bar{S}_{1,1},\,
\bar{S}_{2,1},\, \cdots,
\bar{S}_{\mathrm{nmax\_file},1},\,\bar{S}_{2,2},\, \bar{S}_{3,2},\,
\cdots, \bar{S}_{\mathrm{nmax\_file},\mathrm{nmax\_file}},\end{split}\]</div>
</p>
<p>where <code class="docutils literal notranslate"><span class="pre">nmax_file</span></code> is the maximum harmonic degree stored in <code class="docutils literal notranslate"><span class="pre">pathname</span></code>, <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are the scaling parameter of the coefficients and the associated radius of the reference sphere and, finally, <span class="math notranslate nohighlight">\(\bar{C}_{n,m}\)</span> and <span class="math notranslate nohighlight">\(\bar{S}_{n,m}\)</span> are spherical harmonic coefficients of degree <code class="docutils literal notranslate"><span class="pre">n</span></code> and order <code class="docutils literal notranslate"><span class="pre">m</span></code>. It must hold that <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">nmax_file</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;=</span> <span class="pre">nmax</span></code>.</p>
<p><div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If <code class="docutils literal notranslate"><span class="pre">nmax</span></code> is <code class="docutils literal notranslate"><span class="pre">CHARM_SHC_NMAX_MODEL</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>,
the function returns the maximum harmonic degree of <code class="docutils literal notranslate"><span class="pre">pathname</span></code>
without reading the spherical harmonic coefficients.</p>
<p>The rationale behind this behaviour is as follows.  Sometimes, the
maximum degree <code class="docutils literal notranslate"><span class="pre">nmax_file</span></code> from <code class="docutils literal notranslate"><span class="pre">pathname</span></code> is not known when
loading the file.  In that case, the problem is that the input
<code class="docutils literal notranslate"><span class="pre">shcs</span></code> structure needs to be initialized up to a maximum harmonic
degree <code class="docutils literal notranslate"><span class="pre">nmax_shcs</span> <span class="pre">&gt;=</span> <span class="pre">nmax</span></code> before loading the coefficients from
<code class="docutils literal notranslate"><span class="pre">pathname</span></code> up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">nmax_file</span></code>.  With
<code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">=</span> <span class="pre">CHARM_SHC_NMAX_MODEL</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs</span> <span class="pre">=</span> <span class="pre">NULL</span></code>, the maximum
degrees <code class="docutils literal notranslate"><span class="pre">nmax_file</span></code> and <code class="docutils literal notranslate"><span class="pre">nmax</span></code> can be determined before
initializing <code class="docutils literal notranslate"><span class="pre">shcs</span></code>.  The following code snippet illustrates
this:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">charm_err</span><span class="w"> </span><span class="o">*</span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">charm_err_init</span><span class="p">();</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="n">CHARM_FAILURE</span><span class="p">);</span>

<span class="kt">char</span><span class="w"> </span><span class="n">pathname</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/some/path/to/your/model&quot;</span><span class="p">;</span>
<span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">nmax_file</span><span class="p">,</span><span class="w"> </span><span class="n">nmax_shcs</span><span class="p">,</span><span class="w"> </span><span class="n">nmax</span><span class="p">;</span>

<span class="c1">// Get the maximum degree stored in &quot;pathname&quot; without reading</span>
<span class="c1">// its coefficients, that is, without the need to initialize</span>
<span class="c1">// a &quot;charm_shc&quot; structure.</span>
<span class="n">nmax_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">charm_shc_read_bin</span><span class="p">(</span><span class="n">pathname</span><span class="p">,</span><span class="w"> </span><span class="n">CHARM_SHC_NMAX_MODEL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="p">);</span>
<span class="n">charm_err_handler</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Now set &quot;nmax_shcs&quot; to some value equal to or higher</span>
<span class="c1">// than &quot;nmax_file&quot;</span>
<span class="c1">// [Here goes your code]</span>

<span class="c1">// Initialize the &quot;charm_shc&quot; structure to &quot;nmax_shcs&quot;</span>
<span class="n">charm_shc</span><span class="w"> </span><span class="o">*</span><span class="n">shcs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">charm_shc_malloc</span><span class="p">(</span><span class="n">nmax_shcs</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">shcs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="n">CHARM_FAILURE</span><span class="p">);</span>

<span class="c1">// Set &quot;nmax&quot; to some value value equal to or smaller than</span>
<span class="c1">// &quot;nmax_file&quot;</span>
<span class="c1">// [Here goes your code]</span>

<span class="c1">// Finally, read the coefficients from &quot;pathname&quot; up to degree</span>
<span class="c1">// &quot;nmax&quot; to the structure &quot;shcs&quot;</span>
<span class="n">charm_shc_read_bin</span><span class="p">(</span><span class="n">pathname</span><span class="p">,</span><span class="w"> </span><span class="n">nmax</span><span class="p">,</span><span class="w"> </span><span class="n">shcs</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="p">);</span>
<span class="n">charm_err_handler</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function modifies <code class="docutils literal notranslate"><span class="pre">shcs-&gt;c</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;s</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code> by the values from the input file, but it does not touch <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nc</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;ns</span></code>. If <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;</span> <span class="pre">nmax</span></code>, the coefficients beyond <code class="docutils literal notranslate"><span class="pre">nmax</span></code> are set to zero.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Upon successful return, the function returns the maximum harmonic degree from <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. On error, <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a81159bc53ff0bf69090ab5e066739849"><span class="std std-ref"><span class="pre">CHARM_SHC_NMAX_ERROR</span></span></a></code> is returned in addition to the error reporting through <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418charm_shc_read_gfcPKcmPKcP9charm_shcP9charm_err">
<span id="_CPPv318charm_shc_read_gfcPKcmPKcP9charm_shcP9charm_err"></span><span id="_CPPv218charm_shc_read_gfcPKcmPKcP9charm_shcP9charm_err"></span><span id="charm_shc_read_gfc__cCP.unsigned-l.cCP.charm_shcP.charm_errP"></span><span class="target" id="charm__shc_8h_1af6995bacff72c260aecb449bf9a41967"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_read_gfc</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pathname</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">epoch</span></span>, <a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418charm_shc_read_gfcPKcmPKcP9charm_shcP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Reads the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure to <code class="docutils literal notranslate"><span class="pre">shcs</span></code> from the ICGEM’s gfc file whose name is the string pointed to by <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. The coefficients are loaded up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code>. If the file represents a time variable gravity field model, the coefficients are optionally transformed from the model’s default epoch into <code class="docutils literal notranslate"><span class="pre">epoch</span></code>. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. <em>gfc</em> is a format for gravity field models defined by ICGEM at <a class="reference external" href="https://icgem.gfz-potsdam.de/docs/ICGEM-Format-2023.pdf">https://icgem.gfz-potsdam.de/docs/ICGEM-Format-2023.pdf</a>.</p>
<p>The date string in <code class="docutils literal notranslate"><span class="pre">epoch</span></code> must follow either the pattern <code class="docutils literal notranslate"><span class="pre">yyyyMMdd</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;20050217&quot;</span></code> for Feb 17, 2005) or <code class="docutils literal notranslate"><span class="pre">yyyyMMdd.hhmm</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;20050217.1359&quot;</span></code> for Feb 17, 2005, 13:59).</p>
<p><ul class="simple">
<li><p>For static models, <code class="docutils literal notranslate"><span class="pre">epoch</span></code> is ignored and can be either <code class="docutils literal notranslate"><span class="pre">NULL</span></code> or a valid date string (which is still ignored though).</p></li>
<li><p>If the format of the file is <code class="docutils literal notranslate"><span class="pre">icgem1.0</span></code> or if the format is not specified, <code class="docutils literal notranslate"><span class="pre">epoch</span></code> can be either a valid date string or it can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>. If <code class="docutils literal notranslate"><span class="pre">epoch</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code> and the file represents a time variable gravity field model, the model’s default epoch is used. No specification of the format implies <code class="docutils literal notranslate"><span class="pre">icgem1.0</span></code> as per definition.</p></li>
<li><p>If the format of the file is <code class="docutils literal notranslate"><span class="pre">icgem2.0</span></code>, <code class="docutils literal notranslate"><span class="pre">epoch</span></code> must be a valid date string.</p></li>
</ul>
</p>
<p>In each leap year, the month of February has 29 days instead of 28 days. The date strings <code class="docutils literal notranslate"><span class="pre">&quot;20050217.2400&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;20050218&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;20050218.0000&quot;</span></code> represent the same epoch. Similarly, <code class="docutils literal notranslate"><span class="pre">&quot;20050217.1360&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;20050217.1400&quot;</span></code> are equal epochs. Date strings having the format <code class="docutils literal notranslate"><span class="pre">&quot;yyyyMMdd.2460&quot;</span></code> are not allowed.</p>
<p>It must hold that <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">nmax_file</span></code>, where <code class="docutils literal notranslate"><span class="pre">nmax_file</span></code> is taken from the <code class="docutils literal notranslate"><span class="pre">max_degree</span></code> keyword of the <em>gfc</em> file, and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;=</span> <span class="pre">nmax</span></code>.</p>
<p><div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If <code class="docutils literal notranslate"><span class="pre">nmax</span></code> is <code class="docutils literal notranslate"><span class="pre">CHARM_SHC_NMAX_MODEL</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>,
the function returns the maximum harmonic degree of <code class="docutils literal notranslate"><span class="pre">pathname</span></code>
without reading the spherical harmonic coefficients.</p>
<p>For a use-case, see the tip from the documentation to
<code class="docutils literal notranslate"><span class="pre">charm_shc_read_bin()</span></code>, but keep in mind that this function
has one additional input parameter when compared with
<code class="docutils literal notranslate"><span class="pre">charm_shc_read_bin()</span></code>.</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function modifies <code class="docutils literal notranslate"><span class="pre">shcs-&gt;c</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;s</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code> by the values from the input file, but it does not touch <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nc</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;ns</span></code>. If <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;</span> <span class="pre">nmax</span></code>, the coefficients beyond <code class="docutils literal notranslate"><span class="pre">nmax</span></code> are set to zero.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Upon successful return, the function returns the maximum harmonic degree from <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. On error, <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a81159bc53ff0bf69090ab5e066739849"><span class="std std-ref"><span class="pre">CHARM_SHC_NMAX_ERROR</span></span></a></code> is returned in addition to the error reporting through <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418charm_shc_read_tblPKcmP9charm_shcP9charm_err">
<span id="_CPPv318charm_shc_read_tblPKcmP9charm_shcP9charm_err"></span><span id="_CPPv218charm_shc_read_tblPKcmP9charm_shcP9charm_err"></span><span id="charm_shc_read_tbl__cCP.unsigned-l.charm_shcP.charm_errP"></span><span class="target" id="charm__shc_8h_1ad38866f0da4c14d02631c4ddbb723a1a"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_read_tbl</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pathname</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418charm_shc_read_tblPKcmP9charm_shcP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Reads the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure to <code class="docutils literal notranslate"><span class="pre">shcs</span></code> from a text file whose name is the string pointed to by <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. The structure is loaded up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code>. The file is assumed to has been created by <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a95356f08a6928da143ebdc5eb6fc1df6"><span class="std std-ref"><span class="pre">charm_shc_write_tbl()</span></span></a></code>. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
<p>The first line of the input file must specify the maximum harmonic degree <code class="docutils literal notranslate"><span class="pre">nmax_file</span></code> of the coefficients stored in the file, their scaling parameter <code class="docutils literal notranslate"><span class="pre">mu</span></code> and the radius of the reference sphere <code class="docutils literal notranslate"><span class="pre">r</span></code>. Then, starting at a new line, provided must be a harmonic degree, harmonic order and the respective pair of coefficients per each line of the file. The entire file structure can be summarized as:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
\mathrm{nmax\_file} &amp; \mu &amp; R\\
0 &amp; 0 &amp; \bar{C}_{0,0} &amp; \bar{S}_{0,0}\\
1 &amp; 0 &amp; \bar{C}_{1,0} &amp; \bar{S}_{1,0}\\
1 &amp; 1 &amp; \bar{C}_{1,1} &amp; \bar{S}_{1,1}\\
2 &amp; 0 &amp; \bar{C}_{2,0} &amp; \bar{S}_{2,0}\\
2 &amp; 1 &amp; \bar{C}_{2,1} &amp; \bar{S}_{2,1}\\
2 &amp; 2 &amp; \bar{C}_{2,2} &amp; \bar{S}_{2,2}\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\mathrm{nmax\_file} &amp; \mathrm{nmax\_file}
&amp; \bar{C}_{\mathrm{nmax\_file},\mathrm{nmax\_file}}
&amp; \bar{S}_{\mathrm{nmax\_file},\mathrm{nmax\_file}}\\
\end{matrix}\end{split}\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are the scaling parameter of the coefficients and the associated radius of the reference sphere and <span class="math notranslate nohighlight">\(\bar{C}_{n,m}\)</span> and <span class="math notranslate nohighlight">\(\bar{S}_{n,m}\)</span> are spherical harmonic coefficients of degree <code class="docutils literal notranslate"><span class="pre">n</span></code> and order <code class="docutils literal notranslate"><span class="pre">m</span></code>. It must hold that <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">nmax_file</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;=</span> <span class="pre">nmax</span></code>. Lines specifying spherical harmonic coefficients (all lines after the first one) can be sorted arbitrarily. The non-existing coefficients <span class="math notranslate nohighlight">\(\bar{S}_{n,0}\)</span> of order <code class="docutils literal notranslate"><span class="pre">0</span></code> do not need to be present in the file.</p>
<p><div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If <code class="docutils literal notranslate"><span class="pre">nmax</span></code> is <code class="docutils literal notranslate"><span class="pre">CHARM_SHC_NMAX_MODEL</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>,
the function returns the maximum harmonic degree of <code class="docutils literal notranslate"><span class="pre">pathname</span></code>
without reading the spherical harmonic coefficients.</p>
<p>For a use-case, see the tip from the documentation to
<code class="docutils literal notranslate"><span class="pre">charm_shc_read_bin()</span></code>.</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function modifies <code class="docutils literal notranslate"><span class="pre">shcs-&gt;c</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;s</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code> by the values from the input file, but it does not touch <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nc</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;ns</span></code>. If <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;</span> <span class="pre">nmax</span></code>, the coefficients beyond <code class="docutils literal notranslate"><span class="pre">nmax</span></code> are set to zero.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Upon successful return, the function returns the maximum harmonic degree from <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. On error, <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a81159bc53ff0bf69090ab5e066739849"><span class="std std-ref"><span class="pre">CHARM_SHC_NMAX_ERROR</span></span></a></code> is returned in addition to the error reporting through <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418charm_shc_read_dovPKcmP9charm_shcP9charm_err">
<span id="_CPPv318charm_shc_read_dovPKcmP9charm_shcP9charm_err"></span><span id="_CPPv218charm_shc_read_dovPKcmP9charm_shcP9charm_err"></span><span id="charm_shc_read_dov__cCP.unsigned-l.charm_shcP.charm_errP"></span><span class="target" id="charm__shc_8h_1a8964cfa35210c0504a66352d4a08de62"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_read_dov</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pathname</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418charm_shc_read_dovPKcmP9charm_shcP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Reads the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure to <code class="docutils literal notranslate"><span class="pre">shcs</span></code> from a text file whose name is the string pointed to by <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. The structure is loaded up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code>. The file is assumed to has been created by <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1af258616c1b47504cb50243c23d7d1060"><span class="std std-ref"><span class="pre">charm_shc_write_dov()</span></span></a></code>. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. <code class="docutils literal notranslate"><span class="pre">dov</span></code> is an abbreviation for the <em>degree</em>, <em>order</em>, <em>value</em> format. </p>
<p>The first line of the input file must specify the maximum harmonic degree <code class="docutils literal notranslate"><span class="pre">nmax_file</span></code> of the coefficients stored in the file, their scaling parameter <code class="docutils literal notranslate"><span class="pre">mu</span></code> and the radius of the reference sphere <code class="docutils literal notranslate"><span class="pre">r</span></code>. Then, starting at a new line, each line must specify a harmonic degree, signed harmonic order (positive for <span class="math notranslate nohighlight">\(\bar{C}_{nm}\)</span>, negative for <span class="math notranslate nohighlight">\(\bar{S}_{nm}\)</span>) and the respective coefficient (either <span class="math notranslate nohighlight">\(\bar{C}_{nm}\)</span> or <span class="math notranslate nohighlight">\(\bar{S}_{nm}\)</span>, depending on the sign of the order). The entire file structure can be summarized as:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
\mathrm{nmax\_file} &amp; \mu &amp; R\\
0 &amp; 0 &amp; \bar{C}_{0,0}\\
1 &amp; 0 &amp; \bar{C}_{1,0}\\
1 &amp; 1 &amp; \bar{C}_{1,1}\\
1 &amp; -1 &amp; \bar{S}_{1,1}\\
2 &amp; 0 &amp; \bar{C}_{2,0}\\
2 &amp; 1 &amp; \bar{C}_{2,1}\\
2 &amp; -1 &amp; \bar{S}_{2,1}\\
2 &amp; 2 &amp; \bar{C}_{2,2}\\
2 &amp; -2 &amp; \bar{S}_{2,2}\\
\vdots &amp; \vdots &amp; \vdots \\
\mathrm{nmax\_file} &amp; -\mathrm{nmax\_file}
&amp; \bar{S}_{\mathrm{nmax\_file},\mathrm{nmax\_file}}\\
\end{matrix}\end{split}\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are the scaling parameter of the coefficients and the associated radius of the reference sphere and <span class="math notranslate nohighlight">\(\bar{C}_{n,m}\)</span> and <span class="math notranslate nohighlight">\(\bar{S}_{n,m}\)</span> are spherical harmonic coefficients of degree <code class="docutils literal notranslate"><span class="pre">n</span></code> and order <code class="docutils literal notranslate"><span class="pre">m</span></code>. It must hold that <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">nmax_file</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;=</span> <span class="pre">nmax</span></code>. Lines specifying spherical harmonic coefficients (all lines after the first one) can be sorted arbitrarily.</p>
<p><div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If <code class="docutils literal notranslate"><span class="pre">nmax</span></code> is <code class="docutils literal notranslate"><span class="pre">CHARM_SHC_NMAX_MODEL</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>,
the function returns the maximum harmonic degree of <code class="docutils literal notranslate"><span class="pre">pathname</span></code>
without reading the spherical harmonic coefficients.</p>
<p>For a use-case, see the tip from the documentation to
<code class="docutils literal notranslate"><span class="pre">charm_shc_read_bin()</span></code>.</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function modifies <code class="docutils literal notranslate"><span class="pre">shcs-&gt;c</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;s</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code> by the values from the input file, but it does not touch <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nc</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;ns</span></code>. If <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;</span> <span class="pre">nmax</span></code>, the coefficients beyond <code class="docutils literal notranslate"><span class="pre">nmax</span></code> are set to zero.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Upon successful return, the function returns the maximum harmonic degree from <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. On error, <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a81159bc53ff0bf69090ab5e066739849"><span class="std std-ref"><span class="pre">CHARM_SHC_NMAX_ERROR</span></span></a></code> is returned in addition to the error reporting through <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418charm_shc_read_mtxPKcmP9charm_shcP9charm_err">
<span id="_CPPv318charm_shc_read_mtxPKcmP9charm_shcP9charm_err"></span><span id="_CPPv218charm_shc_read_mtxPKcmP9charm_shcP9charm_err"></span><span id="charm_shc_read_mtx__cCP.unsigned-l.charm_shcP.charm_errP"></span><span class="target" id="charm__shc_8h_1a15f826d9e23977fd774db07c11a22939"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_read_mtx</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pathname</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418charm_shc_read_mtxPKcmP9charm_shcP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Reads the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure to <code class="docutils literal notranslate"><span class="pre">shcs</span></code> from a text file whose name is the string pointed to by <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. The structure is loaded up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code>. The file is assumed to has been created by <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1aa8a9ddb41faa2793a67218ca46ec040f"><span class="std std-ref"><span class="pre">charm_shc_write_mtx()</span></span></a></code>. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
<p>The first line of the input file must specify the maximum harmonic degree <code class="docutils literal notranslate"><span class="pre">nmax_file</span></code> of the coefficients stored in the file, their scaling parameter <code class="docutils literal notranslate"><span class="pre">mu</span></code> and the radius of the reference sphere <code class="docutils literal notranslate"><span class="pre">r</span></code>. Then, starting at a new line, a matrix with a predefined structured specifying the coefficients must follow. The entire file structure can be summarized as:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
\mathrm{nmax\_file} &amp; \mu &amp; R\\
\bar{C}_{00} &amp; \bar{S}_{11} &amp;  \bar{S}_{21} &amp; \bar{S}_{31} &amp;
    \cdots &amp;\bar{S}_{\mathrm{nmax\_file},1}\\
\bar{C}_{10} &amp; \bar{C}_{11} &amp;  \bar{S}_{22} &amp; \bar{S}_{32} &amp;
\cdots &amp; \bar{S}_{\mathrm{nmax\_file},2}\\
\bar{C}_{20} &amp; \bar{C}_{21} &amp;  \bar{C}_{22} &amp; \bar{S}_{33} &amp; \cdots 
&amp; \bar{S}_{\mathrm{nmax\_file},3}\\
\bar{C}_{30} &amp; \bar{C}_{31} &amp;  \bar{C}_{32} &amp; \bar{C}_{33} &amp; \cdots
&amp; \bar{S}_{\mathrm{nmax\_file},4}\\
\vdots&amp; \vdots&amp; \vdots&amp; \vdots&amp; \ddots &amp; \vdots \\
\bar{C}_{\mathrm{nmax\_file},0} &amp; \bar{C}_{\mathrm{nmax\_file},1}
&amp; \bar{C}_{\mathrm{nmax\_file},2} &amp; \bar{C}_{\mathrm{nmax\_file},3}
&amp; \cdots
&amp; \bar{C}_{\mathrm{nmax\_file},\mathrm{nmax\_file}} \end{matrix}\end{split}\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are the scaling parameter of the coefficients and the associated radius of the reference sphere and <span class="math notranslate nohighlight">\(\bar{C}_{n,m}\)</span> and <span class="math notranslate nohighlight">\(\bar{S}_{n,m}\)</span> are spherical harmonic coefficients of degree <code class="docutils literal notranslate"><span class="pre">n</span></code> and order <code class="docutils literal notranslate"><span class="pre">m</span></code>. It must hold that <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">nmax_file</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;=</span> <span class="pre">nmax</span></code>.</p>
<p>Any empty line in the file (that is, containing only the new line character <code class="docutils literal notranslate"><span class="pre">\n</span></code>) is ignored.</p>
<p><div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If <code class="docutils literal notranslate"><span class="pre">nmax</span></code> is <code class="docutils literal notranslate"><span class="pre">CHARM_SHC_NMAX_MODEL</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>,
the function returns the maximum harmonic degree of <code class="docutils literal notranslate"><span class="pre">pathname</span></code>
without reading the spherical harmonic coefficients.</p>
<p>For a use-case, see the tip from the documentation to
<code class="docutils literal notranslate"><span class="pre">charm_shc_read_bin()</span></code>.</p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function modifies <code class="docutils literal notranslate"><span class="pre">shcs-&gt;c</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;s</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code> by the values from the input file, but it does not touch <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span></code>, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nc</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;ns</span></code>. If <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;</span> <span class="pre">nmax</span></code>, the coefficients beyond <code class="docutils literal notranslate"><span class="pre">nmax</span></code> are set to zero.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Upon successful return, the function returns the maximum harmonic degree from <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. On error, <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a81159bc53ff0bf69090ab5e066739849"><span class="std std-ref"><span class="pre">CHARM_SHC_NMAX_ERROR</span></span></a></code> is returned in addition to the error reporting through <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419charm_shc_write_binPK9charm_shcmPKcP9charm_err">
<span id="_CPPv319charm_shc_write_binPK9charm_shcmPKcP9charm_err"></span><span id="_CPPv219charm_shc_write_binPK9charm_shcmPKcP9charm_err"></span><span id="charm_shc_write_bin__charm_shcCP.unsigned-l.cCP.charm_errP"></span><span class="target" id="charm__shc_8h_1acd4b855357c012625ddf89a6625970dd"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_write_bin</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pathname</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419charm_shc_write_binPK9charm_shcmPKcP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Writes <code class="docutils literal notranslate"><span class="pre">shcs</span></code> up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code> to a binary file whose name is the string pointed to by <code class="docutils literal notranslate"><span class="pre">pathname</span></code>. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
<p>The output file is a binary representation of <code class="docutils literal notranslate"><span class="pre">shcs</span></code> up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code> in the following order:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}&amp;\mathrm{nmax}, \mu, \, R, \, \bar{C}_{0,0}, \, \bar{C}_{1,0}, \, 
\bar{C}_{2,0}, \, \cdots, \bar{C}_{\mathrm{nmax},0}, 
\bar{C}_{1,1},\, \bar{C}_{2,1}, \, \cdots,\\
&amp;\bar{C}_{\mathrm{nmax},1}, \, \bar{C}_{2,2}, \bar{C}_{3,2},\, 
\cdots,\, \bar{C}_{\mathrm{nmax},\mathrm{nmax}},\, \bar{S}_{0,0},\, 
\bar{S}_{1,0},\, \bar{S}_{2,0},\, \cdots,\\
&amp;\bar{S}_{\mathrm{nmax},0},\, \bar{S}_{1,1},\, \bar{S}_{2,1},\, 
\cdots, \bar{S}_{\mathrm{nmax},1},\,\bar{S}_{2,2},\, 
\bar{S}_{3,2},\, \cdots, \bar{S}_{\mathrm{nmax},\mathrm{nmax}},\end{split}\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are the scaling parameter of the coefficients and the associated radius of the reference sphere and <span class="math notranslate nohighlight">\(\bar{C}_{n,m}\)</span> and <span class="math notranslate nohighlight">\(\bar{S}_{n,m}\)</span> are spherical harmonic coefficients of degree <code class="docutils literal notranslate"><span class="pre">n</span></code> and order <code class="docutils literal notranslate"><span class="pre">m</span></code>. It must hold that <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">shcs-&gt;nmax</span></code>.</p>
<p>The path to the output file in <code class="docutils literal notranslate"><span class="pre">pathname</span></code> must already exist. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419charm_shc_write_tblPK9charm_shcmPKciPKcP9charm_err">
<span id="_CPPv319charm_shc_write_tblPK9charm_shcmPKciPKcP9charm_err"></span><span id="_CPPv219charm_shc_write_tblPK9charm_shcmPKciPKcP9charm_err"></span><span id="charm_shc_write_tbl__charm_shcCP.unsigned-l.cCP.i.cCP.charm_errP"></span><span class="target" id="charm__shc_8h_1a95356f08a6928da143ebdc5eb6fc1df6"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_write_tbl</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">formatting</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ordering</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pathname</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419charm_shc_write_tblPK9charm_shcmPKciPKcP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Writes <code class="docutils literal notranslate"><span class="pre">shcs</span></code> up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code> to a text file whose name is the string pointed to by <code class="docutils literal notranslate"><span class="pre">pathname</span></code> using the <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifier and the <code class="docutils literal notranslate"><span class="pre">ordering</span></code> scheme for ordering spherical harmonic coefficients. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
<p>The <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifier is used for all <em>floating point</em> data of <code class="docutils literal notranslate"><span class="pre">shcs</span></code>. No extra characters before or after the formatting specifier are expected, not even the space (no internal check). Examples of valid <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifiers in double precision are <code class="docutils literal notranslate"><span class="pre">%0.16e</span></code>, <code class="docutils literal notranslate"><span class="pre">%24.16e</span></code> or <code class="docutils literal notranslate"><span class="pre">%0.16f</span></code>. The <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifiers may vary with the precision of the library (single, double or quadruple).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">ordering</span></code> is <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1adc29c2ff13d900c2f185ee95427fb06caa5b2a2605b9550934047696f069a2098"><span class="std std-ref"><span class="pre">CHARM_SHC_WRITE_N</span></span></a></code>, the output file has the following structure:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
\mathrm{nmax} &amp; \mu &amp; R\\
0 &amp; 0 &amp; \bar{C}_{0,0} &amp; \bar{S}_{0,0}\\
1 &amp; 0 &amp; \bar{C}_{1,0} &amp; \bar{S}_{1,0}\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\mathrm{nmax} &amp; 0 &amp; \bar{C}_{\mathrm{nmax},0}
&amp; \bar{S}_{\mathrm{nmax},0}\\
1 &amp; 1 &amp; \bar{C}_{1,1} &amp; \bar{S}_{1,1}\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\mathrm{nmax} &amp; 1 &amp; \bar{C}_{\mathrm{nmax},1}
&amp; \bar{S}_{\mathrm{nmax},1}\\
2 &amp; 2 &amp; \bar{C}_{2,2} &amp; \bar{S}_{2,2}\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\mathrm{nmax} &amp; \mathrm{nmax}
&amp; \bar{C}_{\mathrm{nmax},\mathrm{nmax}}
&amp; \bar{S}_{\mathrm{nmax},\mathrm{nmax}}\\
\end{matrix}\end{split}\]</div>
</p>
<p>If <code class="docutils literal notranslate"><span class="pre">ordering</span></code> is <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1adc29c2ff13d900c2f185ee95427fb06ca5d67bd07813e1758d057c6e6514aef30"><span class="std std-ref"><span class="pre">CHARM_SHC_WRITE_M</span></span></a></code>, the output file has the following structure:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
\mathrm{nmax} &amp; \mu &amp; R\\
0 &amp; 0 &amp; \bar{C}_{0,0} &amp; \bar{S}_{0,0}\\
1 &amp; 0 &amp; \bar{C}_{1,0} &amp; \bar{S}_{1,0}\\
1 &amp; 1 &amp; \bar{C}_{1,1} &amp; \bar{S}_{1,1}\\
2 &amp; 0 &amp; \bar{C}_{2,0} &amp; \bar{S}_{2,0}\\
2 &amp; 1 &amp; \bar{C}_{2,1} &amp; \bar{S}_{2,1}\\
2 &amp; 2 &amp; \bar{C}_{2,2} &amp; \bar{S}_{2,2}\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\mathrm{nmax} &amp; \mathrm{nmax}
&amp; \bar{C}_{\mathrm{nmax},\mathrm{nmax}}
&amp; \bar{S}_{\mathrm{nmax},\mathrm{nmax}}\\
\end{matrix}\end{split}\]</div>
</p>
<p>In either case, <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are the scaling parameter of the coefficients and the associated radius of the reference sphere and <span class="math notranslate nohighlight">\(\bar{C}_{n,m}\)</span> and <span class="math notranslate nohighlight">\(\bar{S}_{n,m}\)</span> are spherical harmonic coefficients of degree <code class="docutils literal notranslate"><span class="pre">n</span></code> and order <code class="docutils literal notranslate"><span class="pre">m</span></code>. It must hold that <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">shcs-&gt;nmax</span></code>.</p>
<p>
The path to the output file in <code class="docutils literal notranslate"><span class="pre">pathname</span></code> must already exist. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the quadruple version of CHarm (<code class="docutils literal notranslate"><span class="pre">charmq_shc_write_tbl()</span></code>), add the <code class="docutils literal notranslate"><span class="pre">Q</span></code> letter to the <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifier. Examples of valid <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifiers in quadruple precision are <code class="docutils literal notranslate"><span class="pre">%0.34Qe</span></code>, <code class="docutils literal notranslate"><span class="pre">%40.34Qe</span></code> or <code class="docutils literal notranslate"><span class="pre">%0.34Qf</span></code> (see the documentation to <code class="docutils literal notranslate"><span class="pre">libquadmath</span></code>).</p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419charm_shc_write_dovPK9charm_shcmPKciPKcP9charm_err">
<span id="_CPPv319charm_shc_write_dovPK9charm_shcmPKciPKcP9charm_err"></span><span id="_CPPv219charm_shc_write_dovPK9charm_shcmPKciPKcP9charm_err"></span><span id="charm_shc_write_dov__charm_shcCP.unsigned-l.cCP.i.cCP.charm_errP"></span><span class="target" id="charm__shc_8h_1af258616c1b47504cb50243c23d7d1060"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_write_dov</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">formatting</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ordering</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pathname</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419charm_shc_write_dovPK9charm_shcmPKciPKcP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Writes <code class="docutils literal notranslate"><span class="pre">shcs</span></code> up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code> to a text file whose name is the string pointed to by <code class="docutils literal notranslate"><span class="pre">pathname</span></code> using the <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifier. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. <code class="docutils literal notranslate"><span class="pre">dov</span></code> is an abbreviation for the <em>degree</em>, <em>order</em>, <em>value</em> formatting. </p>
<p>The <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifier is used for all <em>floating point</em> data of <code class="docutils literal notranslate"><span class="pre">shcs</span></code>. No extra characters before or after the formatting specifier are expected, not even the space (no internal check). Examples of valid <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifiers in double precision are <code class="docutils literal notranslate"><span class="pre">%0.16e</span></code>, <code class="docutils literal notranslate"><span class="pre">%24.16e</span></code> or <code class="docutils literal notranslate"><span class="pre">%0.16f</span></code>. The <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifiers may vary with the precision of the library (single, double or quadruple).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">ordering</span></code> is <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1adc29c2ff13d900c2f185ee95427fb06caa5b2a2605b9550934047696f069a2098"><span class="std std-ref"><span class="pre">CHARM_SHC_WRITE_N</span></span></a></code>, the output file has the following structure:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
\mathrm{nmax} &amp; \mu &amp; R\\
0 &amp; 0 &amp; \bar{C}_{0,0}\\
1 &amp; 0 &amp; \bar{C}_{1,0}\\
2 &amp; 0 &amp; \bar{C}_{2,0}\\
1 &amp; 1 &amp; \bar{C}_{1,1}\\
1 &amp; -1 &amp; \bar{S}_{1,1}\\
2 &amp; 1 &amp; \bar{C}_{2,1}\\
2 &amp; -1 &amp; \bar{S}_{2,1}\\
2 &amp; 2 &amp; \bar{C}_{2,2}\\
2 &amp; -2 &amp; \bar{S}_{2,2}\\
\vdots &amp; \vdots &amp; \vdots \\
\mathrm{nmax} &amp; -\mathrm{nmax}
&amp; \bar{S}_{\mathrm{nmax},\mathrm{nmax}}\\
\end{matrix}\end{split}\]</div>
</p>
<p>If <code class="docutils literal notranslate"><span class="pre">ordering</span></code> is <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1adc29c2ff13d900c2f185ee95427fb06ca5d67bd07813e1758d057c6e6514aef30"><span class="std std-ref"><span class="pre">CHARM_SHC_WRITE_M</span></span></a></code>, the output file has the following structure:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
\mathrm{nmax} &amp; \mu &amp; R\\
0 &amp; 0 &amp; \bar{C}_{0,0}\\
1 &amp; 0 &amp; \bar{C}_{1,0}\\
1 &amp; 1 &amp; \bar{C}_{1,1}\\
1 &amp; -1 &amp; \bar{S}_{1,1}\\
2 &amp; 0 &amp; \bar{C}_{2,0}\\
2 &amp; 1 &amp; \bar{C}_{2,1}\\
2 &amp; -1 &amp; \bar{S}_{2,1}\\
2 &amp; 2 &amp; \bar{C}_{2,2}\\
2 &amp; -2 &amp; \bar{S}_{2,2}\\
\vdots &amp; \vdots &amp; \vdots \\
\mathrm{nmax} &amp; -\mathrm{nmax}
&amp; \bar{S}_{\mathrm{nmax},\mathrm{nmax}}\\
\end{matrix}\end{split}\]</div>
</p>
<p>In either case, <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are the scaling parameter of the coefficients and the associated radius of the reference sphere and <span class="math notranslate nohighlight">\(\bar{C}_{n,m}\)</span> and <span class="math notranslate nohighlight">\(\bar{S}_{n,m}\)</span> are spherical harmonic coefficients of degree <code class="docutils literal notranslate"><span class="pre">n</span></code> and order <code class="docutils literal notranslate"><span class="pre">m</span></code>. It must hold that <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">shcs-&gt;nmax</span></code>.</p>
<p>The path to the output file in <code class="docutils literal notranslate"><span class="pre">pathname</span></code> must already exist.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the quadruple version of CHarm (<code class="docutils literal notranslate"><span class="pre">charmq_shc_write_dov()</span></code>), add the <code class="docutils literal notranslate"><span class="pre">Q</span></code> letter to the <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifier. Examples of valid <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifiers in quadruple precision are <code class="docutils literal notranslate"><span class="pre">%0.34Qe</span></code>, <code class="docutils literal notranslate"><span class="pre">%40.34Qe</span></code> or <code class="docutils literal notranslate"><span class="pre">%0.34Qf</span></code> (see the documentation to <code class="docutils literal notranslate"><span class="pre">libquadmath</span></code>). </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419charm_shc_write_mtxPK9charm_shcmPKcPKcP9charm_err">
<span id="_CPPv319charm_shc_write_mtxPK9charm_shcmPKcPKcP9charm_err"></span><span id="_CPPv219charm_shc_write_mtxPK9charm_shcmPKcPKcP9charm_err"></span><span id="charm_shc_write_mtx__charm_shcCP.unsigned-l.cCP.cCP.charm_errP"></span><span class="target" id="charm__shc_8h_1aa8a9ddb41faa2793a67218ca46ec040f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_write_mtx</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">formatting</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pathname</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419charm_shc_write_mtxPK9charm_shcmPKcPKcP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Writes <code class="docutils literal notranslate"><span class="pre">shcs</span></code> up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code> to a text file whose name is the string pointed to by <code class="docutils literal notranslate"><span class="pre">pathname</span></code> using the <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifier. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
<p>The <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifier is used for all <em>floating point</em> data of <code class="docutils literal notranslate"><span class="pre">shcs</span></code>. No extra characters before or after the formatting specifier are expected, not even the space (no internal check). Examples of valid <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifiers in double precision are <code class="docutils literal notranslate"><span class="pre">%0.16e</span></code>, <code class="docutils literal notranslate"><span class="pre">%24.16e</span></code> or <code class="docutils literal notranslate"><span class="pre">%0.16f</span></code>. The <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifiers may vary with the precision of the library (single, double or quadruple).</p>
<p>The output file has the following structure:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
\mathrm{nmax} &amp; \mu &amp; R\\
\bar{C}_{00} &amp; \bar{S}_{11} &amp;  \bar{S}_{21} &amp; \bar{S}_{31} &amp;
    \cdots &amp;\bar{S}_{\mathrm{nmax},1}\\
\bar{C}_{10} &amp; \bar{C}_{11} &amp;  \bar{S}_{22} &amp; \bar{S}_{32} &amp;
\cdots &amp; \bar{S}_{\mathrm{nmax},2}\\
\bar{C}_{20} &amp; \bar{C}_{21} &amp;  \bar{C}_{22} &amp; \bar{S}_{33} &amp; \cdots 
&amp; \bar{S}_{\mathrm{nmax},3}\\
\bar{C}_{30} &amp; \bar{C}_{31} &amp;  \bar{C}_{32} &amp; \bar{C}_{33} &amp; \cdots
&amp; \bar{S}_{\mathrm{nmax},4}\\
\vdots&amp;\vdots &amp;\vdots &amp; \vdots&amp; \ddots &amp; \vdots \\
\bar{C}_{\mathrm{nmax},0} &amp; \bar{C}_{\mathrm{nmax},1}
&amp; \bar{C}_{\mathrm{nmax},2} &amp; \bar{C}_{\mathrm{nmax},3} &amp; \cdots
&amp; \bar{C}_{\mathrm{nmax},\mathrm{nmax}} \end{matrix}\end{split}\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are the scaling parameter of the coefficients and the associated radius of the reference sphere and <span class="math notranslate nohighlight">\(\bar{C}_{n,m}\)</span> and <span class="math notranslate nohighlight">\(\bar{S}_{n,m}\)</span> are spherical harmonic coefficients of degree <code class="docutils literal notranslate"><span class="pre">n</span></code> and order <code class="docutils literal notranslate"><span class="pre">m</span></code>. It must hold that <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">shcs-&gt;nmax</span></code>.</p>
<p>
The path to the output file in <code class="docutils literal notranslate"><span class="pre">pathname</span></code> must already exist. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the quadruple version of CHarm (<code class="docutils literal notranslate"><span class="pre">charmq_shc_write_mtx()</span></code>), add the <code class="docutils literal notranslate"><span class="pre">Q</span></code> letter to the <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifier. Examples of valid <code class="docutils literal notranslate"><span class="pre">formatting</span></code> specifiers in quadruple precision are <code class="docutils literal notranslate"><span class="pre">%0.34Qe</span></code>, <code class="docutils literal notranslate"><span class="pre">%40.34Qe</span></code> or <code class="docutils literal notranslate"><span class="pre">%0.34Qf</span></code> (see the documentation to <code class="docutils literal notranslate"><span class="pre">libquadmath</span></code>).</p>
</div>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-spectrum-from-the-charm_shc-structure">Spectrum from the charm_shc structure</p>
<p>These functions compute the spectrum from the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure in the form of (difference) degree variances and (difference) degree amplitudes. </p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412charm_shc_dvPK9charm_shcmPdP9charm_err">
<span id="_CPPv312charm_shc_dvPK9charm_shcmPdP9charm_err"></span><span id="_CPPv212charm_shc_dvPK9charm_shcmPdP9charm_err"></span><span id="charm_shc_dv__charm_shcCP.unsigned-l.doubleP.charm_errP"></span><span class="target" id="charm__shc_8h_1a5949c61d37a35de181d4eb13e3abb38c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_dv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dv</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412charm_shc_dvPK9charm_shcmPdP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Computes degree variances (spectrum) <code class="docutils literal notranslate"><span class="pre">dv</span></code> up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code> of a signal given by spherical harmonic coefficients in <code class="docutils literal notranslate"><span class="pre">shcs</span></code>. Each array index of <code class="docutils literal notranslate"><span class="pre">dv</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, …, <code class="docutils literal notranslate"><span class="pre">nmax</span></code>, corresponds to the degree variance of the respective degree <code class="docutils literal notranslate"><span class="pre">n</span></code>. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
<p>The degree variances are given as</p>
<p><div class="math notranslate nohighlight">
\[\mathrm{dv}_n = \sum_{m = 0}^{n}(\bar{C}_{nm}^2 + \bar{S}_{nm}^2) \,.\]</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code> parameters are <strong>not</strong> used to evaluate the degree variances, since this appears to be the most common way in practice. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412charm_shc_daPK9charm_shcmPdP9charm_err">
<span id="_CPPv312charm_shc_daPK9charm_shcmPdP9charm_err"></span><span id="_CPPv212charm_shc_daPK9charm_shcmPdP9charm_err"></span><span id="charm_shc_da__charm_shcCP.unsigned-l.doubleP.charm_errP"></span><span class="target" id="charm__shc_8h_1ad468f56a0cc7cc1b0bc18c762f9feb3e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_da</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">da</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412charm_shc_daPK9charm_shcmPdP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Computes degree amplitudes (square root of degree variances) <code class="docutils literal notranslate"><span class="pre">da</span></code> up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code> of a signal given by spherical harmonic coefficients in <code class="docutils literal notranslate"><span class="pre">shcs</span></code>. Each array index of <code class="docutils literal notranslate"><span class="pre">da</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, …, <code class="docutils literal notranslate"><span class="pre">nmax</span></code>, corresponds to the degree amplitude of the respective degree <code class="docutils literal notranslate"><span class="pre">n</span></code>. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
<p>The degree amplitudes are given as</p>
<p><div class="math notranslate nohighlight">
\[\mathrm{da}_n = \sqrt{\sum_{m = 0}^{n}(\bar{C}_{nm}^2 
+ \bar{S}_{nm}^2)} \,.\]</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code> parameters are <strong>not</strong> used to evaluate the degree amplitudes, since this appears to be the most common way in practice. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413charm_shc_ddvPK9charm_shcPK9charm_shcmPdP9charm_err">
<span id="_CPPv313charm_shc_ddvPK9charm_shcPK9charm_shcmPdP9charm_err"></span><span id="_CPPv213charm_shc_ddvPK9charm_shcPK9charm_shcmPdP9charm_err"></span><span id="charm_shc_ddv__charm_shcCP.charm_shcCP.unsigned-l.doubleP.charm_errP"></span><span class="target" id="charm__shc_8h_1ab593fb4ffa422cb66ce24f3bfb47210f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_ddv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs1</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs2</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ddv</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413charm_shc_ddvPK9charm_shcPK9charm_shcmPdP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Computes difference degree variances (difference spectrum) <code class="docutils literal notranslate"><span class="pre">ddv</span></code> up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code> between a signal given by spherical harmonic coefficients in <code class="docutils literal notranslate"><span class="pre">shcs1</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs2</span></code>. Each array index of <code class="docutils literal notranslate"><span class="pre">ddv</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, …, <code class="docutils literal notranslate"><span class="pre">nmax</span></code>, corresponds to the difference degree variance of the respective degree <code class="docutils literal notranslate"><span class="pre">n</span></code>. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
<p>The difference degree variances are given as</p>
<p><div class="math notranslate nohighlight">
\[\mathrm{ddv}_n = \sum_{m = 0}^{n}\left(\left(\bar{C}_{nm}^{(1)} - 
\bar{C}_{nm}^{(2)}\right)^2 + \left(\bar{S}_{nm}^{(1)} 
- \bar{S}_{nm}^{(2)}\right)^2\right) \,.\]</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code> parameters are <strong>not</strong> used to evaluate the differece degree variances, since this appears to be the most common way in practice. However, the values of <code class="docutils literal notranslate"><span class="pre">mu</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span></code> in <code class="docutils literal notranslate"><span class="pre">shcs1</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs2</span></code> <strong>must</strong> be equal (the function performs a check on this). </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413charm_shc_ddaPK9charm_shcPK9charm_shcmPdP9charm_err">
<span id="_CPPv313charm_shc_ddaPK9charm_shcPK9charm_shcmPdP9charm_err"></span><span id="_CPPv213charm_shc_ddaPK9charm_shcPK9charm_shcmPdP9charm_err"></span><span id="charm_shc_dda__charm_shcCP.charm_shcCP.unsigned-l.doubleP.charm_errP"></span><span class="target" id="charm__shc_8h_1ad49ab54172a113f5bf7fbf9e4a58f22a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_dda</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs1</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs2</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmax</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">da</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413charm_shc_ddaPK9charm_shcPK9charm_shcmPdP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Computes difference degree amplitudes (square root of difference degree variances) <code class="docutils literal notranslate"><span class="pre">dda</span></code> up to degree <code class="docutils literal notranslate"><span class="pre">nmax</span></code> between a signal given by spherical harmonic coefficients in <code class="docutils literal notranslate"><span class="pre">shcs1</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs2</span></code>. Each array index of <code class="docutils literal notranslate"><span class="pre">dda</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, …, <code class="docutils literal notranslate"><span class="pre">nmax</span></code>, corresponds to the difference degree amplitude of the respective degree <code class="docutils literal notranslate"><span class="pre">n</span></code>. Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
<p>The difference degree amplitudes are given as</p>
<p><div class="math notranslate nohighlight">
\[\mathrm{dda}_n = \sqrt{\sum_{m = 0}^{n}\left(\left(\bar{C}_{nm}^{(1)} - 
\bar{C}_{nm}^{(2)}\right)^2 + \left(\bar{S}_{nm}^{(1)} 
- \bar{S}_{nm}^{(2)}\right)^2\right)} \,.\]</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code> parameters are <strong>not</strong> used to evaluate the difference degree amplitudes, since this appears to be the most common way in practice. However, the values of <code class="docutils literal notranslate"><span class="pre">mu</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span></code> in <code class="docutils literal notranslate"><span class="pre">shcs1</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs2</span></code> <strong>must</strong> be equal (the function performs a check on this). </p>
</div>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-miscellaneous-functions">Miscellaneous functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417charm_shc_rescaleP9charm_shcddP9charm_err">
<span id="_CPPv317charm_shc_rescaleP9charm_shcddP9charm_err"></span><span id="_CPPv217charm_shc_rescaleP9charm_shcddP9charm_err"></span><span id="charm_shc_rescale__charm_shcP.double.double.charm_errP"></span><span class="target" id="charm__shc_8h_1a1d014b8a7da1bd76d4ea49df16ec9cb5"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc_rescale</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv49charm_shc" title="charm_shc"><span class="n"><span class="pre">charm_shc</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">shcs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">munew</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rnew</span></span>, <a class="reference internal" href="api-c-err.html#_CPPv49charm_err" title="charm_err"><span class="n"><span class="pre">charm_err</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417charm_shc_rescaleP9charm_shcddP9charm_err" title="Link to this definition">#</a><br /></dt>
<dd><p>Rescales spherical harmonic coefficients in <code class="docutils literal notranslate"><span class="pre">shcs</span></code> to a new scaling parameter <code class="docutils literal notranslate"><span class="pre">munew</span></code> and a new radius of the reference sphere <code class="docutils literal notranslate"><span class="pre">rnew</span></code>: </p>
<p><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\bar{C}_{nm}^{\mathrm{new}} = \frac{\mu}{\mu_{\mathrm{new}}} \, \left(
               \frac{R}{R_{\mathrm{new}}} \right)^n \,
               \bar{C}_{nm}\,,\\\end{split}\\\bar{S}_{nm}^{\mathrm{new}} = \frac{\mu}{\mu_{\mathrm{new}}} \, \left(
               \frac{R}{R_{\mathrm{new}}} \right)^n \, \bar{S}_{nm}\,.\end{aligned}\end{align} \]</div>
</p>
<p>After the conversion, <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code> are updated to <code class="docutils literal notranslate"><span class="pre">munew</span></code> and <code class="docutils literal notranslate"><span class="pre">rnew</span></code>, respectively.</p>
<p>Error reported by the function (if any) is written to <code class="docutils literal notranslate"><span class="pre">err</span></code>. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv4Ut1_4">
<span id="_CPPv3Ut1_4"></span><span class="target" id="charm__shc_8h_1adc29c2ff13d900c2f185ee95427fb06c"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">[anonymous]</span></span></span><a class="headerlink" href="#_CPPv4Ut1_4" title="Link to this definition">#</a><br /></dt>
<dd><p>Ordering scheme to write spherical harmonic coefficients with <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a95356f08a6928da143ebdc5eb6fc1df6"><span class="std std-ref"><span class="pre">charm_shc_write_tbl()</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1af258616c1b47504cb50243c23d7d1060"><span class="std std-ref"><span class="pre">charm_shc_write_dov()</span></span></a></code>. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4NUt1_417CHARM_SHC_WRITE_NE">
<span id="_CPPv3NUt1_417CHARM_SHC_WRITE_NE"></span><span class="target" id="charm__shc_8h_1adc29c2ff13d900c2f185ee95427fb06caa5b2a2605b9550934047696f069a2098"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CHARM_SHC_WRITE_N</span></span></span><a class="headerlink" href="#_CPPv4NUt1_417CHARM_SHC_WRITE_NE" title="Link to this definition">#</a><br /></dt>
<dd><p>Harmonic degree varies fastest. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4NUt1_417CHARM_SHC_WRITE_ME">
<span id="_CPPv3NUt1_417CHARM_SHC_WRITE_ME"></span><span class="target" id="charm__shc_8h_1adc29c2ff13d900c2f185ee95427fb06ca5d67bd07813e1758d057c6e6514aef30"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CHARM_SHC_WRITE_M</span></span></span><a class="headerlink" href="#_CPPv4NUt1_417CHARM_SHC_WRITE_ME" title="Link to this definition">#</a><br /></dt>
<dd><p>Harmonic order varies fastest. </p>
</dd></dl>

</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv49charm_shc">
<span id="_CPPv39charm_shc"></span><span id="_CPPv29charm_shc"></span><span id="charm_shc"></span><span class="target" id="structcharm__shc"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">charm_shc</span></span></span><a class="headerlink" href="#_CPPv49charm_shc" title="Link to this definition">#</a><br /></dt>
<dd><p>Structure to store spherical harmonic coefficients and some associated data.</p>
<p>If CHarm is compiled with the MPI support, the data of the structure can be distributed across MPI processes. This is useful if your dataset is so large that it would not fit into the RAM of a single computing node. The members of the structure are therefore divided into two groups.</p>
<p><ul class="simple">
<li><p>Members common to both non-distributed and distributed structures. These are always accessible.</p></li>
<li><p>Members specific to distributed structures only. These are accessible only when CHarm was compiled with the MPI support. </p></li>
</ul>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-members-common-to-non-distributed-and-distributed-structures">Members common to non-distributed and distributed structures</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc4nmaxE">
<span id="_CPPv3N9charm_shc4nmaxE"></span><span id="_CPPv2N9charm_shc4nmaxE"></span><span id="charm_shc::nmax__unsigned-l"></span><span class="target" id="structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nmax</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc4nmaxE" title="Link to this definition">#</a><br /></dt>
<dd><p>Maximum harmonic degree of the spherical harmonic coefficients. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc2muE">
<span id="_CPPv3N9charm_shc2muE"></span><span id="_CPPv2N9charm_shc2muE"></span><span id="charm_shc::mu__double"></span><span class="target" id="structcharm__shc_1a241fa5b0edae9a1574e948e5a6269b68"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mu</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc2muE" title="Link to this definition">#</a><br /></dt>
<dd><p>Scaling parameter <span class="math notranslate nohighlight">\(\mu\)</span> associated with the spherical harmonic coefficients, for instance, the geocentric gravitational constant. In case the coefficients are not associated with any scaling parameter (as it is, for instance, with planetary topographies), simply set this variable to <code class="docutils literal notranslate"><span class="pre">1.0</span></code> (not to <code class="docutils literal notranslate"><span class="pre">0.0</span></code>!). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc1rE">
<span id="_CPPv3N9charm_shc1rE"></span><span id="_CPPv2N9charm_shc1rE"></span><span id="charm_shc::r__double"></span><span class="target" id="structcharm__shc_1a847dadddf26eeffc5b5060f4f745d20a"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">r</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc1rE" title="Link to this definition">#</a><br /></dt>
<dd><p>Radius of the reference sphere <span class="math notranslate nohighlight">\(R\)</span>, to which the spherical harmonic coefficients refer (are scaled). The value must be larger than zero. To get the unit sphere, as needed, for instance, when working with planetary topographies, set this variable to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc2ncE">
<span id="_CPPv3N9charm_shc2ncE"></span><span id="_CPPv2N9charm_shc2ncE"></span><span id="charm_shc::nc__s"></span><span class="target" id="structcharm__shc_1ad185b3c1c7ef5d327fb7c382f6d4f486"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nc</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc2ncE" title="Link to this definition">#</a><br /></dt>
<dd><p>Total number of spherical harmonic coefficients <span class="math notranslate nohighlight">\(\bar{C}_{nm}\)</span>. The value is always larger than zero. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc2nsE">
<span id="_CPPv3N9charm_shc2nsE"></span><span id="_CPPv2N9charm_shc2nsE"></span><span id="charm_shc::ns__s"></span><span class="target" id="structcharm__shc_1a36033e975da459d60220cbb32560848a"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ns</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc2nsE" title="Link to this definition">#</a><br /></dt>
<dd><p>Total number of spherical harmonic coefficients <span class="math notranslate nohighlight">\(\bar{S}_{nm}\)</span>. The value is always larger than zero. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc1cE">
<span id="_CPPv3N9charm_shc1cE"></span><span id="_CPPv2N9charm_shc1cE"></span><span id="charm_shc::c__doublePP"></span><span class="target" id="structcharm__shc_1aec89546b6e791b22c41e47531cae878f"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">c</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc1cE" title="Link to this definition">#</a><br /></dt>
<dd><p>Spherical harmonic coefficients <span class="math notranslate nohighlight">\(\bar{C}_{nm}\)</span> stored as a 2D array. The first dimension is related to harmonic orders and the second one to harmonic degrees. Importantly, the number of columns varies for each row as follows:</p>
<p><ul class="simple">
<li><p>Order <code class="docutils literal notranslate"><span class="pre">0</span></code>: <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a><span class="pre">[0]</span></code> has <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"><span class="std std-ref"><span class="pre">charm_shc.nmax</span></span></a> <span class="pre">+</span> <span class="pre">1</span></code> columns for degrees <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, …, <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"><span class="std std-ref"><span class="pre">charm_shc.nmax</span></span></a></code> (respectively),</p></li>
<li><p>Order <code class="docutils literal notranslate"><span class="pre">1</span></code>: <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a><span class="pre">[1]</span></code> has <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"><span class="std std-ref"><span class="pre">charm_shc.nmax</span></span></a></code> columns for degrees <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, …, <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"><span class="std std-ref"><span class="pre">charm_shc.nmax</span></span></a></code> (respectively),</p></li>
<li><p>Order <code class="docutils literal notranslate"><span class="pre">2</span></code>: <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a><span class="pre">[2]</span></code> has <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"><span class="std std-ref"><span class="pre">charm_shc.nmax</span></span></a> <span class="pre">-</span> <span class="pre">1</span></code> columns for degrees <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">3</span></code>, …, <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"><span class="std std-ref"><span class="pre">charm_shc.nmax</span></span></a></code> (respectively),</p></li>
<li><p>…</p></li>
<li><p>Order <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"><span class="std std-ref"><span class="pre">charm_shc.nmax</span></span></a></code>: <code class="docutils literal notranslate"><span class="pre">c[</span><a class="reference internal" href="#structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"><span class="std std-ref"><span class="pre">charm_shc.nmax</span></span></a><span class="pre">]</span></code> has <code class="docutils literal notranslate"><span class="pre">1</span></code> column for degree <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a1eb06a3601467c3a4d11d09527ca5c7d"><span class="std std-ref"><span class="pre">charm_shc.nmax</span></span></a></code>.</p></li>
</ul>
</p>
<p>
Assuming the <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> structure was initialized up to some degree <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">nmax</span></code> as</p>
<p><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">charm_shc</span><span class="w"> </span><span class="o">*</span><span class="n">shcs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">charm_shc_calloc</span><span class="p">(</span><span class="n">nmax</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>
</pre></div>
</div>
</p>
<p>harmonic coefficients of degree <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&lt;=</span> <span class="pre">nmax</span></code> and order <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">&lt;=</span> <span class="pre">n</span></code> can be accessed as:</p>
<p><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">shcs</span><span class="o">-&gt;</span><span class="n">c</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m</span><span class="p">];</span>
</pre></div>
</div>
</p>
<p>The coefficients in <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a></code> are stored in a contiguous block of memory. For fast sequential access, the loop over harmonic orders should always be the outer one, in which the degree-dependent loop is nested, such as:</p>
<p><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">charm_shc</span><span class="w"> </span><span class="o">*</span><span class="n">shcs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">charm_shc_calloc</span><span class="p">(</span><span class="n">nmax</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nmax</span><span class="p">;</span><span class="w"> </span><span class="n">m</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nmax</span><span class="p">;</span><span class="w"> </span><span class="n">n</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">shcs</span><span class="o">-&gt;</span><span class="n">c</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m</span><span class="p">];</span>
</pre></div>
</div>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a></code> is <em>not</em> a 2D rectangular array.</p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc1sE">
<span id="_CPPv3N9charm_shc1sE"></span><span id="_CPPv2N9charm_shc1sE"></span><span id="charm_shc::s__doublePP"></span><span class="target" id="structcharm__shc_1a6818b02906586ec66ddf28095c779558"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">s</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc1sE" title="Link to this definition">#</a><br /></dt>
<dd><p>Spherical harmonic coefficients <span class="math notranslate nohighlight">\(\bar{S}_{nm}\)</span>. The same comments as for <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a></code> apply to <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a6818b02906586ec66ddf28095c779558"><span class="std std-ref"><span class="pre">charm_shc.s</span></span></a></code>, too. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc5ownerE">
<span id="_CPPv3N9charm_shc5ownerE"></span><span id="_CPPv2N9charm_shc5ownerE"></span><span id="charm_shc::owner___Bool"></span><span class="target" id="structcharm__shc_1afa2a47ef5dfb21b8c01fa506b17859af"></span><span class="n"><span class="pre">_Bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">owner</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc5ownerE" title="Link to this definition">#</a><br /></dt>
<dd><p><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">1</span></code>, the spherical harmonic coefficients in <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a6818b02906586ec66ddf28095c779558"><span class="std std-ref"><span class="pre">charm_shc.s</span></span></a></code> were allocated by CHarm, so <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1ac787c43697c5383d38c392d427b78669"><span class="std std-ref"><span class="pre">charm_shc_free()</span></span></a></code> deallocates them. This is the case with <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> returned by <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a4895f2b307f1ce52ed05804ab6db9df8"><span class="std std-ref"><span class="pre">charm_shc_malloc()</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1abc13dd997021be52d8f317562738ad14"><span class="std std-ref"><span class="pre">charm_shc_calloc()</span></span></a></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">0</span></code>, the coefficients in <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a6818b02906586ec66ddf28095c779558"><span class="std std-ref"><span class="pre">charm_shc.s</span></span></a></code> were allocated outside CHarm, so <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1ac787c43697c5383d38c392d427b78669"><span class="std std-ref"><span class="pre">charm_shc_free()</span></span></a></code> does <em>not</em> deallocate them (the user allocated this memory outside CHarm, so the user should free the memory outside CHarm as well). This is the case with <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> returned by <code class="docutils literal notranslate"><a class="reference internal" href="#charm__shc_8h_1a634b6af02cca801de4e51c2248d72b20"><span class="std std-ref"><span class="pre">charm_shc_init()</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="api-c-mpi.html#charm__mpi_8h_1ade483c15d62f78323d77488f72d00eb7"><span class="std std-ref"><span class="pre">charm_mpi_shc_init()</span></span></a></code>. </p></li>
</ul>
</p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc11distributedE">
<span id="_CPPv3N9charm_shc11distributedE"></span><span id="_CPPv2N9charm_shc11distributedE"></span><span id="charm_shc::distributed___Bool"></span><span class="target" id="structcharm__shc_1a8d7afa2ae075e75529008ec97ee20b1b"></span><span class="n"><span class="pre">_Bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distributed</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc11distributedE" title="Link to this definition">#</a><br /></dt>
<dd><p><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">0</span></code>, the structure is not distributed, meaning that each process (be it an OpenMP or MPI process) accesses the same data through <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a></code>, <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a6818b02906586ec66ddf28095c779558"><span class="std std-ref"><span class="pre">charm_shc.s</span></span></a></code> and, if compiled with MPI support, <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1adf572eb83bceaabf961e8abd47f9422c"><span class="std std-ref"><span class="pre">charm_shc.local_order</span></span></a></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">1</span></code>, the structure is distributed across MPI processes, that is, each MPI process accesses different data through <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a></code>, <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a6818b02906586ec66ddf28095c779558"><span class="std std-ref"><span class="pre">charm_shc.s</span></span></a></code> and, if compiled with MPI support, <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1adf572eb83bceaabf961e8abd47f9422c"><span class="std std-ref"><span class="pre">charm_shc.local_order</span></span></a></code>.</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If CHarm was compiled without the MPI support (default), <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a8d7afa2ae075e75529008ec97ee20b1b"><span class="std std-ref"><span class="pre">charm_shc.distributed</span></span></a></code> is always <code class="docutils literal notranslate"><span class="pre">0</span></code>. </p>
</div>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-members-available-to-distributed-structures-only">Members available to distributed structures only</p>
<p><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The members that follow are available only when CHarm is compiled with the MPI support (<code class="docutils literal notranslate"><span class="pre">--enable-mpi</span></code>, refer to <a class="reference external" href="./api-c-mpi.html">charm_mpi</a> for further details). </p>
</div>
</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc8local_ncE">
<span id="_CPPv3N9charm_shc8local_ncE"></span><span id="_CPPv2N9charm_shc8local_ncE"></span><span id="charm_shc::local_nc__s"></span><span class="target" id="structcharm__shc_1ac5b507aadfd79bf5aae97450fe4151c7"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">local_nc</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc8local_ncE" title="Link to this definition">#</a><br /></dt>
<dd><p>Total number of spherical harmonic coefficients <span class="math notranslate nohighlight">\(\bar{C}_{nm}\)</span> locally accessible to an MPI process. If <code class="docutils literal notranslate"><span class="pre">0</span></code>, no coefficients are stored locally. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc8local_nsE">
<span id="_CPPv3N9charm_shc8local_nsE"></span><span id="_CPPv2N9charm_shc8local_nsE"></span><span id="charm_shc::local_ns__s"></span><span class="target" id="structcharm__shc_1ace7c509afd88322a954e88fc8c83a130"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">local_ns</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc8local_nsE" title="Link to this definition">#</a><br /></dt>
<dd><p>Total number of spherical harmonic coefficients <span class="math notranslate nohighlight">\(\bar{S}_{nm}\)</span> locally accessible to an MPI process. If <code class="docutils literal notranslate"><span class="pre">0</span></code>, no coefficients are stored locally. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc12local_nchunkE">
<span id="_CPPv3N9charm_shc12local_nchunkE"></span><span id="_CPPv2N9charm_shc12local_nchunkE"></span><span id="charm_shc::local_nchunk__s"></span><span class="target" id="structcharm__shc_1ac39effb39d17225fe9e75e4d25602fd7"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">local_nchunk</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc12local_nchunkE" title="Link to this definition">#</a><br /></dt>
<dd><p>Total number of chunks of spherical harmonic orders that are stored locally. If <code class="docutils literal notranslate"><span class="pre">0</span></code>, no chunks are stored locally. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc11local_orderE">
<span id="_CPPv3N9charm_shc11local_orderE"></span><span id="_CPPv2N9charm_shc11local_orderE"></span><span id="charm_shc::local_order__unsigned-lP"></span><span class="target" id="structcharm__shc_1adf572eb83bceaabf961e8abd47f9422c"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">local_order</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc11local_orderE" title="Link to this definition">#</a><br /></dt>
<dd><p>Spherical harmonic orders specifying chunks of spherical harmonic coefficients that are locally available to an MPI process. The pointer is <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1ac39effb39d17225fe9e75e4d25602fd7"><span class="std std-ref"><span class="pre">charm_shc.local_nchunk</span></span></a></code> is <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>Assume there is <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">=</span> <a class="reference internal" href="#structcharm__shc_1ac39effb39d17225fe9e75e4d25602fd7"><span class="std std-ref"><span class="pre">charm_shc.local_nchunk</span></span></a></code> local chunks. The pointer <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1adf572eb83bceaabf961e8abd47f9422c"><span class="std std-ref"><span class="pre">charm_shc.local_order</span></span></a></code> points to an array of <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">k</span></code> elements having the structure:</p>
<p><div class="math notranslate nohighlight">
\[\underbrace{m_0, m_1}_{\textrm{chunk 0}} | \underbrace{m_2,
m_3}_{\textrm{chunk 1}} | \underbrace{...}_{\textrm{chunks 2 to }k
- 2} | \underbrace{m_{2k - 2}, m_{2k - 1}}_{\textrm{chunk }k
- 1}{,}\]</div>
</p>
<p>where <span class="math notranslate nohighlight">\(m_{2j}\)</span> and <span class="math notranslate nohighlight">\(m_{2j + 1}\)</span>, <span class="math notranslate nohighlight">\(j = 0, 1, ..., k - 1\)</span>, denote the minimum and the maximum orders of the chunks, respectively. Spherical harmonic coefficients <span class="math notranslate nohighlight">\(\bar{C}_{nm}\)</span> and <span class="math notranslate nohighlight">\(\bar{S}_{nm}\)</span> of all degrees <span class="math notranslate nohighlight">\(n = m, m + 1, ...,
  n_{\textrm{max}}\)</span> and orders <span class="math notranslate nohighlight">\(m = m_{2j}, ..., m_{2j + 1}\)</span>, <span class="math notranslate nohighlight">\(j
  = 0, 1, ..., k - 1\)</span>, are accessible to an MPI process through <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a6818b02906586ec66ddf28095c779558"><span class="std std-ref"><span class="pre">charm_shc.s</span></span></a></code>. The ordering of the coefficients in <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1aec89546b6e791b22c41e47531cae878f"><span class="std std-ref"><span class="pre">charm_shc.c</span></span></a></code> is then as follows:</p>
<p><div class="math notranslate nohighlight">
\[\underbrace{\bar{C}_{m_0, m_0}, \bar{C}_{m_0 + 1, m_0}, ...,
\bar{C}_{\mathrm{nmax}, m_0}, \bar{C}_{m_0 + 1, m_0 + 1},
... ,\bar{C}_{\mathrm{nmax}, m_0 + 1}, ..., \bar{C}_{\mathrm{nmax},
m_1}}_{\textrm{chunk 0}} | \underbrace{\bar{C}_{m_2, m_2}, ...,
\bar{C}_{\mathrm{nmax}, m_3}}_{\textrm{chunk 1}}
| \underbrace{...}_{\textrm{chunks 2 to }k - 2}
| \underbrace{\bar{C}_{m_{2k - 2}, m_{2k - 2}}, ...,
\bar{C}_{\mathrm{nmax}}, m_{2k - 1}}_{\textrm{chunk }k - 1}{.}\]</div>
</p>
<p>The total number of these coefficients is stored in <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1ac5b507aadfd79bf5aae97450fe4151c7"><span class="std std-ref"><span class="pre">charm_shc.local_nc</span></span></a></code>. It can also be determined a priori by <code class="docutils literal notranslate"><a class="reference internal" href="api-c-mpi.html#charm__mpi_8h_1a952e6317796066ccc56bb647c5bb73d0"><span class="std std-ref"><span class="pre">charm_mpi_shc_local_ncs()</span></span></a></code>. The same ordering and the number of coefficients applies to <span class="math notranslate nohighlight">\(\bar{S}_{nm}\)</span> in <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1a6818b02906586ec66ddf28095c779558"><span class="std std-ref"><span class="pre">charm_shc.s</span></span></a></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Whenever creating <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code> through the CHarm’s API, <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc_1adf572eb83bceaabf961e8abd47f9422c"><span class="std std-ref"><span class="pre">charm_shc.local_order</span></span></a></code> is always a deep copy of the user’s original data <code class="docutils literal notranslate"><span class="pre">local_order</span></code>. Users can therefore safely free their original <code class="docutils literal notranslate"><span class="pre">local_order</span></code> array after creating <code class="docutils literal notranslate"><a class="reference internal" href="#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sounds complicated? It isn’t! Have a look at the <a class="reference external" href="./api-c-mpi.html">charm_mpi</a> module and the <a class="reference external" href="./cookbook-c.html#distributed-computing-with-mpi">cookbook</a>. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9charm_shc4commE">
<span id="_CPPv3N9charm_shc4commE"></span><span id="_CPPv2N9charm_shc4commE"></span><span id="charm_shc::comm__MPI_Comm"></span><span class="target" id="structcharm__shc_1a8afc7fe9223b4686016c2263c30e504c"></span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">comm</span></span></span><a class="headerlink" href="#_CPPv4N9charm_shc4commE" title="Link to this definition">#</a><br /></dt>
<dd><p>MPI communicator defining the group of MPI processes to distribute the structure across. </p>
</dd></dl>

</div>
</dd></dl>

</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="api-c.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">CHarm (C API)</p>
      </div>
    </a>
    <a class="right-next"
       href="api-c-crd.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">charm_crd</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv416charm_shc_mallocmdd"><code class="docutils literal notranslate"><span class="pre">charm_shc_malloc()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv416charm_shc_callocmdd"><code class="docutils literal notranslate"><span class="pre">charm_shc_calloc()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv414charm_shc_initmddPdPd"><code class="docutils literal notranslate"><span class="pre">charm_shc_init()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv414charm_shc_freeP9charm_shc"><code class="docutils literal notranslate"><span class="pre">charm_shc_free()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv418charm_shc_read_binPKcmP9charm_shcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_read_bin()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv418charm_shc_read_gfcPKcmPKcP9charm_shcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_read_gfc()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv418charm_shc_read_tblPKcmP9charm_shcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_read_tbl()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv418charm_shc_read_dovPKcmP9charm_shcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_read_dov()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv418charm_shc_read_mtxPKcmP9charm_shcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_read_mtx()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv419charm_shc_write_binPK9charm_shcmPKcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_write_bin()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv419charm_shc_write_tblPK9charm_shcmPKciPKcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_write_tbl()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv419charm_shc_write_dovPK9charm_shcmPKciPKcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_write_dov()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv419charm_shc_write_mtxPK9charm_shcmPKcPKcP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_write_mtx()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv412charm_shc_dvPK9charm_shcmPdP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_dv()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv412charm_shc_daPK9charm_shcmPdP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_da()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv413charm_shc_ddvPK9charm_shcPK9charm_shcmPdP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_ddv()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv413charm_shc_ddaPK9charm_shcPK9charm_shcmPdP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_dda()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv417charm_shc_rescaleP9charm_shcddP9charm_err"><code class="docutils literal notranslate"><span class="pre">charm_shc_rescale()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4Ut1_4"><code class="docutils literal notranslate"><span class="pre">@4</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NUt1_417CHARM_SHC_WRITE_NE"><code class="docutils literal notranslate"><span class="pre">@4::CHARM_SHC_WRITE_N</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4NUt1_417CHARM_SHC_WRITE_ME"><code class="docutils literal notranslate"><span class="pre">@4::CHARM_SHC_WRITE_M</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv49charm_shc"><code class="docutils literal notranslate"><span class="pre">charm_shc</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc4nmaxE"><code class="docutils literal notranslate"><span class="pre">charm_shc::nmax</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc2muE"><code class="docutils literal notranslate"><span class="pre">charm_shc::mu</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc1rE"><code class="docutils literal notranslate"><span class="pre">charm_shc::r</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc2ncE"><code class="docutils literal notranslate"><span class="pre">charm_shc::nc</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc2nsE"><code class="docutils literal notranslate"><span class="pre">charm_shc::ns</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc1cE"><code class="docutils literal notranslate"><span class="pre">charm_shc::c</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc1sE"><code class="docutils literal notranslate"><span class="pre">charm_shc::s</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc5ownerE"><code class="docutils literal notranslate"><span class="pre">charm_shc::owner</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc11distributedE"><code class="docutils literal notranslate"><span class="pre">charm_shc::distributed</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc8local_ncE"><code class="docutils literal notranslate"><span class="pre">charm_shc::local_nc</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc8local_nsE"><code class="docutils literal notranslate"><span class="pre">charm_shc::local_ns</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc12local_nchunkE"><code class="docutils literal notranslate"><span class="pre">charm_shc::local_nchunk</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc11local_orderE"><code class="docutils literal notranslate"><span class="pre">charm_shc::local_order</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N9charm_shc4commE"><code class="docutils literal notranslate"><span class="pre">charm_shc::comm</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Blažej Bucha
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, Blažej Bucha.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Nov 19, 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>